<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Solçš„æ¶æ„å’Œåè¯æ¦‚å¿µ | Auodesy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Auodesy</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-å¤ä¹ " class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/01/%E5%A4%8D%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2024-03-31T16:29:40.000Z" itemprop="datePublished">2024-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Solçš„æ¶æ„å’Œåè¯æ¦‚å¿µ
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="solwen"><a href="#solwen" class="headerlink" title="solwen"></a>solwen</h1><p>è´¦æˆ·åˆ†ç±»ï¼š</p>
<p>æ•°æ®è´¦æˆ·ï¼šç³»ç»Ÿæ‰€æœ‰è´¦æˆ·ã€ç¨‹åºæ´¾ç”Ÿè´¦æˆ·ï¼ˆPDAï¼‰</p>
<p>ç¨‹åºè´¦æˆ·ï¼šç”¨æ¥å­˜å‚¨å¯æ‰§è¡Œç¨‹åº</p>
<p>åŸç”Ÿè´¦æˆ·ï¼šæŒ‡Solanaä¸Šçš„åŸç”Ÿç¨‹åº</p>
<p>Solana ä¸­çš„æ•°æ®è´¦æˆ· <strong>ä¸»è¦åˆ†ä¸ºä¸‰å¤§ç±»</strong>ï¼š</p>
<table>
<thead>
<tr>
<th><strong>è´¦æˆ·ç±»åˆ«</strong></th>
<th><strong>å­ç±»åˆ«</strong></th>
<th><strong>ä¸»è¦ä½œç”¨</strong></th>
<th><strong>æ˜¯å¦å¯æ‰§è¡Œï¼Ÿ</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç³»ç»Ÿè´¦æˆ·ï¼ˆSystem Accountï¼‰</strong></td>
<td>âœ… <strong>é’±åŒ…è´¦æˆ·</strong></td>
<td>å­˜å‚¨ SOLã€ç­¾åäº¤æ˜“ã€æ”¯ä»˜ Gas è´¹</td>
<td>âŒ å¦</td>
</tr>
<tr>
<td><strong>ä»£å¸è´¦æˆ·ï¼ˆToken Accountï¼‰</strong></td>
<td>âœ… <strong>æ™®é€š Token Account</strong></td>
<td>å­˜å‚¨ SPL ä»£å¸ï¼Œå¦‚ USDCã€RAY</td>
<td>âŒ å¦</td>
</tr>
<tr>
<td></td>
<td>âœ… <strong>ATAï¼ˆå…³è” Token è´¦æˆ·ï¼‰</strong></td>
<td>PDA åœ°å€çš„ Token Accountï¼Œé’±åŒ…é»˜è®¤ä½¿ç”¨</td>
<td>âŒ å¦</td>
</tr>
<tr>
<td><strong>ç¨‹åºæ´¾ç”Ÿåœ°å€ï¼ˆPDAï¼‰</strong></td>
<td>âœ… <strong>æ™ºèƒ½åˆçº¦ PDA</strong></td>
<td>ç”±åˆçº¦æ´¾ç”Ÿå‡ºçš„å­˜å‚¨åœ°å€</td>
<td>âŒ å¦</td>
</tr>
<tr>
<td></td>
<td>âœ… <strong>çŠ¶æ€å­˜å‚¨ PDA</strong></td>
<td>ç”±åˆçº¦æ´¾ç”Ÿçš„çŠ¶æ€å­˜å‚¨</td>
<td>âŒ å¦</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">accountï¼ˆä¸ä½¿ç”¨å¼•ç”¨ï¼‰</span><br><span class="line">rent_epoch,lamports,owner,executable,data</span><br><span class="line">accountinfo(ä½¿ç”¨å¼•ç”¨å’Œå†…éƒ¨å¯å˜æ€§)</span><br><span class="line">å¤šäº†key,is_signer,is_writable</span><br></pre></td></tr></table></figure>

<p>key:æ ‡è¯†ç”¨æˆ·IDï¼ŒåŒºåˆ†ä¸åŒçš„å­˜å‚¨æ•°æ®ã€‚è´¦æˆ·æœ¬èº«ä¸ç›´æ¥å­˜å‚¨keyï¼Œç”±infoå¼•ç”¨ï¼Œkeyå­˜å‚¨åœ¨çŠ¶æ€æ•°æ®åº“ï¼ˆstateDBï¼‰é‡Œ</p>
<p>dataåªå­˜å‚¨ç¨‹åºå¯ä»¥ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚SPL Token è´¦æˆ·çš„æ•°æ®æ ¼å¼ã€NFT å…ƒæ•°æ®ã€è´¨æŠ¼ï¼ˆStakingï¼‰ä¿¡æ¯</p>
<p>è´¦æˆ·éƒ½æœ‰ç‹¬ä¸€æ— äºŒçš„åœ°å€ä¸”ç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œå¤§å°ä¸è¶…è¿‡10Mä¸”é™æ€ï¼Œå­˜å‚¨éœ€è¦ä»˜ç§Ÿé‡‘ï¼Œé»˜è®¤è´¦æˆ·æ‰€æœ‰è€…æ˜¯ç³»ç»Ÿè´¦æˆ·</p>
<h2 id="ç¨‹åºæ´¾ç”Ÿè´¦æˆ·PDA"><a href="#ç¨‹åºæ´¾ç”Ÿè´¦æˆ·PDA" class="headerlink" title="ç¨‹åºæ´¾ç”Ÿè´¦æˆ·PDA"></a>ç¨‹åºæ´¾ç”Ÿè´¦æˆ·PDA</h2><p>å¿…é¡»ä½¿ç”¨ä¸“ç”¨æŒ‡ä»¤åˆ›å»ºï¼ŒfindProgramAddressï¼ˆseeds,programidï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cargo new sol</span><br><span class="line">cargo add solana_client</span><br><span class="line">solana_sdk</span><br><span class="line">solana_program</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨SDKè·å–è´¦æˆ·ä¿¡æ¯ï¼Œè·å–ç©ºæŠ•ï¼Œè½¬ç§»solana</p>
<p>åˆ›å»ºè½¬è´¦æŒ‡ä»¤ã€‚åˆ›å»ºäº¤æ˜“ï¼Œå‘é€äº¤æ˜“</p>
<p>é€šè¿‡JsonRpcè·å–è´¦æˆ·ä¿¡æ¯</p>
<p>solana Rpc APIç„¶ååœ¨uabntuä¸Šè¿è¡Œ</p>
<h1 id="token"><a href="#token" class="headerlink" title="token"></a>token</h1><p>SPLï¼ˆsolana progran libraryï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">token program</span><br><span class="line"></span><br><span class="line">mint account</span><br><span class="line"></span><br><span class="line">token account</span><br><span class="line"></span><br><span class="line">associated token account</span><br><span class="line">ï¼ˆPdaè´¦æˆ·ã€token accountçš„å…¶ä¸­ä¸€ç§ï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="Mint-account"><a href="#Mint-account" class="headerlink" title="Mint account"></a>Mint account</h2><p>ä»£å¸çš„å®šä¹‰å’Œç®¡ç†</p>
<p>å±æ€§ï¼šdecimals(å°æ•°ä½æ•°)ï¼šå®šä¹‰ä»£å¸çš„æœ€å°å•ä½ï¼Œé€šå¸¸æ˜¯0åˆ°9ï¼Œ</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æŸä¸ªä»£å¸çš„ <code>decimals = 18</code>ï¼Œé‚£ä¹ˆ 1 ä¸ªä»£å¸å®é™…ä¸Šåœ¨åŒºå—é“¾ä¸Šè¡¨ç¤ºä¸º <code>10^18</code> ä¸ªæœ€å°å•ä½ï¼ˆä¹Ÿç§°â€œæœ€å°åˆ†å‰²å•ä½â€ï¼‰</p>
<p>supplyï¼ˆä¾›åº”é‡ï¼‰ï¼šä»£å¸çš„å½“å‰æ€»ä¾›åº”é‡ï¼Œmint authorityï¼ˆé“¸å¸æƒé™ï¼‰ï¼Œfreeze authority(å†»ç»“æƒé™ï¼‰</p>
<p>åŠŸèƒ½ï¼šé“¸é€ ä»£å¸ï¼Œé”€æ¯ä»£å¸</p>
<h2 id="Token-account"><a href="#Token-account" class="headerlink" title="Token account"></a>Token account</h2><p>ç”¨äºæŒæœ‰ç‰¹å®šSPL tokençš„è´¦æˆ·ï¼Œä¸åŒçš„ä»£å¸æœ‰ä¸åŒçš„token accountï¼Œè´¦æˆ·ä¹‹é—´æ— æ³•æ··ç”¨</p>
<p>å±æ€§</p>
<p>Amountï¼ˆä½™é¢ï¼‰</p>
<p>ownerï¼ˆæ§åˆ¶è¯¥è´¦æˆ·çš„ç”¨æˆ·æˆ–åˆçº¦åœ°å€ï¼‰</p>
<p>mintï¼šè¯¥è´¦æˆ·ä¸å“ªä¸ªMInt accountç›¸å…³è”</p>
<p>delegateå¯é€‰ï¼ˆä»£ç†è´¦æˆ·ï¼‰ï¼šå¯ä»¥è¢«æˆæƒç®¡ç†è¯¥è´¦æˆ·çš„å…¶ä»–è´¦æˆ·</p>
<p>stateï¼ˆçŠ¶æ€ï¼‰ï¼šè´¦æˆ·æ˜¯å¦å¤„äºå†»ç»“çŠ¶æ€</p>
<p>åŠŸèƒ½ï¼š</p>
<p>æ¥æ”¶å’Œå‘é€ä»£å¸</p>
<p>ä»£ç†æƒé™ç®¡ç†ï¼šå¯ä»¥è®¾ç½®delegateæ¥æˆæƒç¬¬ä¸‰æ–¹ç®¡ç†è¯¥è´¦æˆ·çš„ä»£å¸</p>
<h2 id="ATA"><a href="#ATA" class="headerlink" title="ATA"></a>ATA</h2><p>æ˜¯token accountçš„ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œç®€åŒ–äº†spl tokençš„è´¦æˆ·ç®¡ç†ã€‚ATAæ˜¯è‡ªåŠ¨ä¸ä¸€ä¸ªé’±åŒ…åœ°å€ç»‘å®šçš„è´¦æˆ·ï¼Œæ¯ä¸ªé’±åŒ…åœ°å€å’Œæ¯ä¸ªä»£å¸çš„mintå¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„token account</p>
<p>ç‰¹ç‚¹ï¼šæ¯ä¸ªé’±åŒ…åœ°å€åªèƒ½æœ‰ä¸€ä¸ªå’ŒæŸä¸ªmintå…³è”çš„ataä¸”solanaæä¾›äº†å·¥å…·æ¥è‡ªåŠ¨ç”ŸæˆATAï¼Œå¼€å‘è€…ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†è´¦æˆ·ã€‚</p>
<p>åŠŸèƒ½ï¼šè‡ªåŠ¨å¤„ç†é’±åŒ…åœ°å€ä¸ä»£å¸è´¦æˆ·ä¹‹é—´çš„å…³è”ï¼Œæ–¹ä¾¿ç”¨æˆ·ç®¡ç†ä¸åŒçš„SPL token</p>
<p>åœ¨ <strong>Solana</strong>ï¼Œæ¯ç§ SPL ä»£å¸éƒ½éœ€è¦ä¸€ä¸ª <strong>ç‹¬ç«‹çš„ ATA</strong> è´¦æˆ·æ¥å­˜å‚¨è¯¥ä»£å¸ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATA = findProgramAddress([é’±åŒ…åœ°å€, Token Mint åœ°å€, TOKEN_PROGRAM_ID])</span><br></pre></td></tr></table></figure>

<p><code>spl-token create-account</code> <strong>ä¸ä¼šè‡ªåŠ¨åˆ›å»º ATA</strong>ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Token Accountã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-associated-token-account`</span><br></pre></td></tr></table></figure>

<p> <strong>æ‰ä¼šåˆ›å»ºç¬¦åˆ ATA è§„åˆ™çš„ Token Account</strong>ã€‚</p>
<h3 id="âœ…-ç†è§£æ€»ç»“ï¼ˆç®€æ´ç‰ˆï¼‰"><a href="#âœ…-ç†è§£æ€»ç»“ï¼ˆç®€æ´ç‰ˆï¼‰" class="headerlink" title="âœ… ç†è§£æ€»ç»“ï¼ˆç®€æ´ç‰ˆï¼‰"></a><strong>âœ… ç†è§£æ€»ç»“ï¼ˆç®€æ´ç‰ˆï¼‰</strong></h3><ul>
<li><strong>ATAï¼ˆå…³è” Token Accountï¼‰</strong> æ˜¯ <strong>Token Account çš„å­é›†</strong>ï¼Œä¸“é—¨ç”¨äº <strong>ç”¨æˆ·å­˜å‚¨ä»£å¸</strong>ï¼Œæ¯ä¸ªé’±åŒ… <strong>æ¯ç§ä»£å¸åªèƒ½æœ‰ä¸€ä¸ª ATA</strong>ï¼Œè‡ªåŠ¨ç»‘å®šåˆ°é’±åŒ…ã€‚</li>
<li><strong>Token Accountï¼ˆæ™®é€š Token Accountï¼‰</strong> æ›´çµæ´»ï¼Œ<strong>å¼€å‘è€…å¯ä»¥åˆ›å»ºå¤šä¸ª Token Account</strong>ï¼Œç”¨äº <strong>æ™ºèƒ½åˆçº¦ã€æµåŠ¨æ€§æ± ã€DAO èµ„é‡‘æ± ç­‰</strong>ï¼Œä¸å—é’±åŒ…ç»‘å®šé™åˆ¶ã€‚</li>
<li><strong>æ‰€æœ‰ Token Accountï¼ˆåŒ…æ‹¬ ATAï¼‰æ¯ä¸ªè´¦æˆ·åªèƒ½å­˜å‚¨ä¸€ç§ä»£å¸</strong>ã€‚</li>
<li><strong>ATA ä¹‹é—´å¯ä»¥ç›´æ¥è½¬è´¦</strong>ï¼Œä½† <strong>Token Account å¯ä»¥è½¬è´¦åˆ°ä»»ä½• Token Account</strong>ï¼Œè€Œ ATA åªèƒ½å’Œç»‘å®šçš„é’±åŒ…åŒ¹é…ã€‚</li>
</ul>
<h2 id="å®è·µ"><a href="#å®è·µ" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana-test-validator</span><br><span class="line"></span><br><span class="line">solana config set --keygen </span><br></pre></td></tr></table></figure>



<p>å½“ä½ ä½¿ç”¨ <code>cargo init</code> åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨ç”Ÿæˆ <code>.gitignore</code> æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º <code>cargo init</code> å‘½ä»¤å¹¶ä¸ä¼šè‡ªåŠ¨å‡è®¾ä½ ä¼šä½¿ç”¨ Gitï¼Œä¹Ÿæ²¡æœ‰ä¸º Git é…ç½®é»˜è®¤çš„ <code>.gitignore</code> æ–‡ä»¶ã€‚</p>
<p>é€šè¿‡ <code>cargo init</code> çš„ <code>--vcs</code> æ ‡å¿—æ¥æŒ‡å®šç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆGitï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo init --vcs git solana1</span><br></pre></td></tr></table></figure>

<p>åœ¨cargo tomlä¸ŠåŠ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[workspace]</span><br><span class="line"></span><br><span class="line">members = [</span><br><span class="line"></span><br><span class="line">  &quot;lib&quot;,</span><br><span class="line"></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>åœ¨ubantu</p>
<p>åˆ›å»ºtoken</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-token</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token create-token</span><br><span class="line">Creating token H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 under program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br><span class="line"></span><br><span class="line">Address:  H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br><span class="line">Decimals:  9</span><br><span class="line"></span><br><span class="line">Signature: 61NeuvthTqM77sPMk5ukfacz2rQUDfTLwgFz8qA5RmaNKCBf54M3LDfnhasYzzmwaHBDBRVpHK4iAQwXdky7UtVm</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token account-info --address H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token account-info --address H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br><span class="line"></span><br><span class="line">SPL Token Mint</span><br><span class="line">  Address: H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br><span class="line">  Program: TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br><span class="line">  Supply: 0</span><br><span class="line">  Decimals: 9</span><br><span class="line">  Mint authority: CpikJSEGPJruz1Fhob68xsBZDhPUx7UFc1v1R97rxAC8</span><br><span class="line">  Freeze authority: (not set)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­mint authorityå°±æ˜¯solana config geté‡Œçš„åœ°å€</p>
<p>åˆ›å»ºtoken account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-account [FLAGS] [OPTIONS] &lt;TOKEN_MINT_ADDRESS&gt; [ACCOUNT_KEYPAIR]</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œå¾—åˆ°</p>
<p>15åˆ†44ç§’</p>
<p>ä¸ºä»€ä¹ˆæ˜¯ATAè€Œä¸æ˜¯token account</p>
<p>ä¸ºä»€ä¹ˆåˆ›å»ºäº†åœ¨solanafmä¸Šçœ‹ä¸è§signatureäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA#  spl-token create-account H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br><span class="line">Creating account DxXyadRzEV8mNPPBBynCFfXkjHTbcGcG4XsUWW2EMPef</span><br><span class="line"></span><br><span class="line">Signature: 2TaHg28yhvmFLxJYbuGC5vVNN2y6aRR22fDCqZj4gzrq8h9o4de8zbGycqWBzw9eWWUztN8kVjDnayFNZgyUntiP</span><br></pre></td></tr></table></figure>

<p>ä¸ºæŒ‡å®šåœ°å€åˆ›å»ºtoken account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token create-account H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 --owner /root/account/a2.json</span><br><span class="line">Creating account 8E6xNTBjL9imZY7JZUCY9eGYym57zANG6VGEUk5r81PM</span><br><span class="line"></span><br><span class="line">Signature: 3JLsR743ayqikzfGhwkxvvw1P5hDSgqeBRGBHD4N233nKchCKs2M3Hd9frUwvfR9wWHf9T28AidvmET2Hts4WiGa</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token create-account H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 /root/account/a2.json</span><br><span class="line">Creating account CxiaNAtETLteM373cgSCsHDTRCjzpX6jWootea8yKJ8T</span><br><span class="line">Error: &quot;Error: Account already exists: CxiaNAtETLteM373cgSCsHDTRCjzpX6jWootea8yKJ8T&quot;</span><br></pre></td></tr></table></figure>

<p>å¤±è´¥</p>
<p>è¯¥å‘½ä»¤çš„æ„æ€æ˜¯<strong>è®©è¿™ä¸ª Keypair ä½œä¸º Token Accountï¼Œè€Œä¸æ˜¯ Token Account çš„æ‰€æœ‰è€…</strong>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token account-info --address 8E6xNTBjL9imZY7JZUCY9eGYym57zANG6VGEUk5r81PM</span><br><span class="line"></span><br><span class="line">SPL Token Account</span><br><span class="line">  Address: 8E6xNTBjL9imZY7JZUCY9eGYym57zANG6VGEUk5r81PM</span><br><span class="line">  Program: TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br><span class="line">  Balance: 0</span><br><span class="line">  Decimals: 9</span><br><span class="line">  Mint: H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98</span><br><span class="line">  Owner: CxiaNAtETLteM373cgSCsHDTRCjzpX6jWootea8yKJ8T</span><br><span class="line">  State: Initialized</span><br><span class="line">  Delegation: (not set)</span><br><span class="line">  Close authority: (not set)</span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆä½¿ç”¨åŸæœ‰çš„è´¦æˆ·æ²¡æˆåŠŸï¼Œä½†æ˜¯ä½¿ç”¨spl-token create-account H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 </p>
<p>å› ä¸ºæ–°ç”Ÿæˆçš„åœ°å€ï¼Œè½¬è´¦æˆ–è€…ç©ºæŠ•åå°±å˜æˆsolanaçš„é’±åŒ…åœ°å€äº†ï¼Œä¸èƒ½æˆä¸ºtoken accountäº†ã€‚ <strong>Token è´¦æˆ·åªèƒ½å­˜æŒ‡å®šçš„ SPL Tokenï¼Œä¸èƒ½å­˜ SOL</strong>ï¼Œæ‰€ä»¥ SOL é’±åŒ…å’Œ Token è´¦æˆ·æ˜¯ <strong>ä¸¤ç§ä¸åŒçš„è´¦æˆ·</strong>ã€‚</p>
<p>åœ¨ Solana ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œ<strong>é’±åŒ…è´¦æˆ·</strong>ï¼ˆWallet Accountï¼‰é€šå¸¸æŒ‡çš„æ˜¯ <strong>ç³»ç»Ÿè´¦æˆ·ï¼ˆSystem Accountï¼‰</strong>ï¼Œå³ <strong>ä¸€ä¸ªæŒæœ‰ SOL å¹¶èƒ½è¿›è¡Œäº¤æ˜“çš„è´¦æˆ·</strong>ç³»ç»Ÿè´¦æˆ·ï¼ˆSystem Account &#x2F; Wallet Accountï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-account H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 </span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç›´æ¥åˆ›å»ºçš„æ˜¯ATAè´¦æˆ·</p>
<table>
<thead>
<tr>
<th>è´¦æˆ·ç±»å‹</th>
<th>ä½œç”¨</th>
<th>ä¸»è¦ç”¨é€”</th>
</tr>
</thead>
<tbody><tr>
<td><strong>System Accountï¼ˆç³»ç»Ÿè´¦æˆ·&#x2F;é’±åŒ…è´¦æˆ·ï¼‰</strong></td>
<td>æŒæœ‰ SOL</td>
<td>æ”¯ä»˜ Gas è´¹ã€ç­¾åäº¤æ˜“ã€åˆ›å»º Token è´¦æˆ·</td>
</tr>
<tr>
<td><strong>SPL Token Accountï¼ˆToken è´¦æˆ·ï¼‰</strong></td>
<td>å­˜å‚¨ SPL ä»£å¸ï¼ˆå¦‚ USDC, RAY, è‡ªå®šä¹‰ Tokenï¼‰</td>
<td>å­˜å‚¨å’Œè½¬ç§» SPL Token</td>
</tr>
<tr>
<td><strong>Program Accountï¼ˆç¨‹åºè´¦æˆ·ï¼‰</strong></td>
<td>å­˜å‚¨æ™ºèƒ½åˆçº¦</td>
<td>Solana æ™ºèƒ½åˆçº¦ï¼ˆç±»ä¼¼ EVM åˆçº¦ï¼‰</td>
</tr>
<tr>
<td><strong>PDAï¼ˆProgram Derived Addressï¼‰</strong></td>
<td>ç”±æ™ºèƒ½åˆçº¦æ´¾ç”Ÿçš„åœ°å€</td>
<td>DApp è´¦æˆ·ï¼Œå¦‚ DEXã€æ¸¸æˆå­˜å‚¨ç­‰</td>
</tr>
</tbody></table>
<h3 id="ç»™è´¦æˆ·mint"><a href="#ç»™è´¦æˆ·mint" class="headerlink" title="ç»™è´¦æˆ·mint"></a>ç»™è´¦æˆ·mint</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token mint H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 100</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç»™ç¨‹åºçš„å…³è”è´¦æˆ·ï¼ˆATAè´¦æˆ·ï¼‰mint100</p>
<p>ç»™åˆ«çš„è´¦æˆ·mint</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token mint H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 100 qqM36aXVHFWd9Gke9oA9NEdxqE2DjPDmQbGgfRd6EAc</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token mint H2JdwGdc45rwhW6gPr2ssceK7JtCAb8MEHJFW4MjEt98 100  --help</span><br></pre></td></tr></table></figure>

<h1 id="SPLtokenå®ç°"><a href="#SPLtokenå®ç°" class="headerlink" title="SPLtokenå®ç°"></a>SPLtokenå®ç°</h1><p>solanaé¡¹ç›®ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">processor.rs:æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†æŒ‡ä»¤</span><br><span class="line">state.rsï¼šå®šä¹‰è´¦æˆ·çš„çŠ¶æ€å’Œæ‰©å±•å­—æ®µ</span><br><span class="line">instruction.rs:å®šä¹‰å„ç§ä»£å¸æ“ä½œçš„æŒ‡ä»¤</span><br><span class="line">error.rs:å®šä¹‰äº†ç¨‹åºå¯èƒ½æŠ›å‡ºçš„é”™è¯¯</span><br><span class="line">lib.rs:ç¨‹åºå…¥å£ç‚¹ï¼Œæ±‡æ€»å„ä¸ªæ¨¡å—</span><br></pre></td></tr></table></figure>

<p>æ­¥éª¤tokenäº¤äº’åˆçº¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åˆ›å»ºmintè´¦æˆ·</span><br><span class="line">åˆ›å»ºATAåmintä»£å¸</span><br></pre></td></tr></table></figure>

<p>ç»™é¡¹ç›®åŠ ä¸Šå„ä¸ªrsç»“æ„ã€‚åŠ ä¾èµ–åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[dependencies]</span><br><span class="line">solana-program = &quot;2.1.13&quot;</span><br><span class="line">spl-associated-token-account = &quot;6.0.0&quot;</span><br><span class="line">spl-token = &quot;7.0.0&quot;</span><br><span class="line"></span><br><span class="line">[lib]</span><br><span class="line">crate-type = [&quot;cdylib&quot;, &quot;lib&quot;]</span><br></pre></td></tr></table></figure>

<p><code>crate-type = [&quot;cdylib&quot;, &quot;lib&quot;]</code> è®© <strong>åŒä¸€ä¸ª Rust crate æ—¢å¯ä»¥ä½œä¸º Rust åº“ï¼ˆlibï¼‰ï¼Œä¹Ÿå¯ä»¥ä½œä¸º C åŠ¨æ€åº“ï¼ˆcdylibï¼‰</strong>ã€‚</p>
<p><strong>æ”¯æŒ FFI ç»‘å®š</strong>ï¼ˆä¾‹å¦‚ç»™ Pythonã€C æˆ– Java ä½¿ç”¨ï¼‰</p>
<ul>
<li>ä½œä¸º <code>cdylib</code>ï¼Œå¯ä»¥ç”Ÿæˆ <code>.so/.dll/.dylib</code>ï¼Œä¾› <strong>C è¯­è¨€ã€Pythonã€Java é€šè¿‡ FFI è°ƒç”¨</strong>ã€‚</li>
</ul>
<p>solanaåˆçº¦ä¾èµ–å¾ˆå¤šåŒ…ï¼Œå¿½ç•¥å…¥å£æ–‡ä»¶</p>
<p>åœ¨ <code>Cargo.toml</code> ä¸­ï¼Œ<code>[features]</code> éƒ¨åˆ†ç”¨äºå®šä¹‰ <strong>å¯é€‰åŠŸèƒ½ï¼ˆfeaturesï¼‰</strong>ï¼Œ<code>no-entrypoint = []</code> è¡¨ç¤ºä¸€ä¸ªåä¸º <strong>â€œno-entrypointâ€</strong> çš„ featureï¼Œä½†å®ƒ <strong>æ²¡æœ‰ä¾èµ–ä»»ä½•å…¶ä»– feature</strong>ã€‚</p>
<p>åœ¨ Solana ç¨‹åºä¸­ï¼Œ<code>no-entrypoint</code> **ç”¨äºæ§åˆ¶æ˜¯å¦åŒ…å« <code>entrypoint.rs</code>**ï¼Œé€šå¸¸ç”¨äºåŒºåˆ† <strong>on-chain éƒ¨ç½²</strong> å’Œ <strong>off-chain è°ƒè¯•</strong>ã€‚</p>
<p>ä½¿ç”¨ <code>cargo build --features no-entrypoint</code> å¯ä»¥<strong>æ’é™¤ <code>entrypoint.rs</code>ï¼Œè®©ä»£ç æ›´çµæ´»</strong>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[package]</span><br><span class="line">name = &quot;token&quot;</span><br><span class="line">version = &quot;0.1.0&quot;</span><br><span class="line">edition = &quot;2021&quot;</span><br><span class="line"></span><br><span class="line">[dependencies]</span><br><span class="line">borsh = &quot;1.5.5&quot;</span><br><span class="line">solana-program = &quot;2.1.13&quot;</span><br><span class="line">spl-associated-token-account = &#123;version = &quot;6.0.0&quot;, features = [&quot;no-entrypoint&quot;]&#125;</span><br><span class="line">spl-token = &#123;version = &quot;7.0.0&quot;, features = [&quot;no-entrypoint&quot;]&#125;</span><br><span class="line"></span><br><span class="line">[lib]</span><br><span class="line">crate-type = [&quot;cdylib&quot;, &quot;lib&quot;]</span><br><span class="line"></span><br><span class="line">[features]</span><br><span class="line">no-entrypoint = []</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­</p>
<ul>
<li><code>#[derive(BorshSerialize, BorshDeserialize)]</code> <strong>è®© Rust ç»“æ„ä½“å¯ä»¥è‡ªåŠ¨åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–ä¸º Solana&#x2F;NEAR å…¼å®¹çš„äºŒè¿›åˆ¶æ ¼å¼</strong>ã€‚</li>
<li><strong>Solana æ™ºèƒ½åˆçº¦</strong> é€šå¸¸ä½¿ç”¨ BORSH å¤„ç† <strong>è´¦æˆ·æ•°æ®å­˜å‚¨</strong> å’Œ <strong>æ™ºèƒ½åˆçº¦è°ƒç”¨å‚æ•°</strong>ã€‚</li>
<li><code>try_to_vec()</code> <strong>åºåˆ—åŒ–</strong>ï¼Œ<code>try_from_slice()</code> <strong>ååºåˆ—åŒ–</strong>ã€‚</li>
</ul>
<hr>
<p>ğŸš€ <strong>åœ¨ Solana ç”Ÿæ€ä¸­ï¼Œå¦‚æœä½ è¦å­˜å‚¨å’Œè¯»å–è´¦æˆ·æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨ <code>borsh</code></strong></p>
<p><code>msg!</code> æ˜¯ Solana é‡Œä¸“é—¨ç”¨äº <strong>æ‰“å°æ—¥å¿—</strong> çš„å®ï¼Œç›¸å½“äº Rust æ ‡å‡†åº“çš„ <code>println!</code>ï¼Œä½†é€‚ç”¨äº Solana æ™ºèƒ½åˆçº¦ç¯å¢ƒã€‚</p>
<p>æ—¥å¿—å¯ä»¥åœ¨ <code>solana logs</code> å‘½ä»¤ä¸­æŸ¥çœ‹</p>
<ol>
<li><strong>ä¸èƒ½åœ¨æœ¬åœ° Rust ä»£ç é‡Œè¿è¡Œ</strong>ï¼Œå› ä¸ºå®ƒæ˜¯ Solana è¿è¡Œæ—¶çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><strong>æ—¥å¿—è¾“å‡ºæ€§èƒ½å¼€é”€è¾ƒå¤§</strong>ï¼Œä¸é€‚åˆé¢‘ç¹è°ƒç”¨ï¼Œå¦åˆ™ä¼šå¢åŠ åˆçº¦æ‰§è¡Œæˆæœ¬ã€‚</li>
<li><strong>ä¸èƒ½æ ¼å¼åŒ–å‚æ•°</strong>ï¼Œä¸åƒ <code>println!</code> é‚£æ ·æ”¯æŒ <code>format!</code>ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">invoke(</span><br><span class="line">    &amp;system_instruction::create_account(</span><br><span class="line">        from_pubkey,  // èµ„é‡‘æ¥æºï¼ˆæ”¯ä»˜æ–°è´¦æˆ·ç§Ÿé‡‘ï¼‰</span><br><span class="line">        to_pubkey,    // æ–°åˆ›å»ºçš„è´¦æˆ·</span><br><span class="line">        lamports,     // è¦è½¬å…¥çš„æ–°è´¦æˆ·çš„ SOL ä½™é¢ï¼ˆæ”¯ä»˜ç§Ÿé‡‘ï¼‰</span><br><span class="line">        space,        // æ–°è´¦æˆ·çš„æ•°æ®å¤§å°ï¼ˆå­—èŠ‚ï¼‰</span><br><span class="line">        owner         // è´¦æˆ·çš„æ‰€æœ‰è€…ï¼ˆæ§åˆ¶å®ƒçš„ç¨‹åºï¼‰</span><br><span class="line">    ), </span><br><span class="line">    account_infos,   // äº¤æ˜“æ¶‰åŠçš„è´¦æˆ·ä¿¡æ¯</span><br><span class="line">)?;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>from_pubkey</code></td>
<td>èµ„é‡‘æ¥æºï¼ˆé€šå¸¸æ˜¯åˆ›å»ºè´¦æˆ·çš„ç”¨æˆ·ï¼‰</td>
</tr>
<tr>
<td><code>to_pubkey</code></td>
<td>æ–°åˆ›å»ºçš„è´¦æˆ·çš„å…¬é’¥</td>
</tr>
<tr>
<td><code>lamports</code></td>
<td>åˆ›å»ºè´¦æˆ·æ—¶è½¬å…¥çš„ SOLï¼ˆæ”¯ä»˜ç§Ÿé‡‘ï¼‰</td>
</tr>
<tr>
<td><code>space</code></td>
<td>è¯¥è´¦æˆ·éœ€è¦çš„å­˜å‚¨ç©ºé—´å¤§å°ï¼ˆå­—èŠ‚ï¼‰</td>
</tr>
<tr>
<td><code>owner</code></td>
<td>è¯¥è´¦æˆ·çš„æ‰€æœ‰è€…ï¼ˆå³æ§åˆ¶è¿™ä¸ªè´¦æˆ·çš„æ™ºèƒ½åˆçº¦ï¼‰</td>
</tr>
</tbody></table>
<h2 id="åˆ›å»ºè´¦æˆ·å’Œåˆå§‹åŒ–è´¦æˆ·ä¸åŒçš„invokeæƒ…å†µ"><a href="#åˆ›å»ºè´¦æˆ·å’Œåˆå§‹åŒ–è´¦æˆ·ä¸åŒçš„invokeæƒ…å†µ" class="headerlink" title="åˆ›å»ºè´¦æˆ·å’Œåˆå§‹åŒ–è´¦æˆ·ä¸åŒçš„invokeæƒ…å†µ"></a>åˆ›å»ºè´¦æˆ·å’Œåˆå§‹åŒ–è´¦æˆ·ä¸åŒçš„invokeæƒ…å†µ</h2><p>ç®€å•æ¥è¯´ï¼Œ**<code>invoke</code> ä¸ <code>invoke_signed</code> çš„åŒºåˆ«åœ¨äºåè€…å…è®¸ç¨‹åºâ€œä»£ç­¾â€ä¸€äº›è´¦æˆ·ï¼ˆé€šå¸¸æ˜¯ PDAï¼‰ï¼Œè€Œå‰è€…åˆ™ç›´æ¥ä½¿ç”¨ä¼ å…¥è´¦æˆ·å·²æœ‰çš„ç­¾å**ã€‚</p>
<p>åœ¨ä½ çš„ä»£ç ä¸­ï¼š</p>
<ol>
<li><strong>åˆ›å»ºè´¦æˆ·é˜¶æ®µï¼ˆ<code>create_account</code> æŒ‡ä»¤ï¼‰</strong><ul>
<li>è¿™é‡Œåªéœ€è¦ä»˜æ¬¾è´¦æˆ·ï¼ˆpayerï¼‰æä¾›ç­¾åï¼Œæ–°è´¦æˆ·ï¼ˆmint_accountï¼‰çš„ç§é’¥é€šå¸¸ç”±è°ƒç”¨æ–¹æ‹¥æœ‰æˆ–ä¸éœ€è¦ç­¾åã€‚</li>
<li>å› æ­¤ä½¿ç”¨ <code>invoke</code> å³å¯ï¼Œå› ä¸ºç³»ç»Ÿç¨‹åºåªè¦æ±‚ä»˜æ¬¾è´¦æˆ·ç­¾åï¼Œè€Œæ–°è´¦æˆ·è¿˜æ²¡åˆå§‹åŒ–ï¼Œä¸éœ€è¦å®ƒâ€œç­¾åâ€è¿™æ¡æŒ‡ä»¤ã€‚</li>
</ul>
</li>
<li><strong>åˆå§‹åŒ– Mint é˜¶æ®µï¼ˆ<code>initialize_mint</code> æŒ‡ä»¤ï¼‰</strong><ul>
<li>åˆå§‹åŒ–ä¸€ä¸ª Mint è´¦æˆ·æ—¶ï¼ŒSPL Token ç¨‹åºè¦æ±‚è¯¥è´¦æˆ·ä½œä¸º Mint è´¦æˆ·â€œç­¾åâ€è¿™æ¡æŒ‡ä»¤ï¼Œä»¥è¯æ˜å®ƒè¢«æ­£ç¡®åˆå§‹åŒ–ã€‚</li>
<li>å¦‚æœæ–°åˆ›å»ºçš„ mint_account æ˜¯ç”±ä¸€ä¸ª PDAï¼ˆProgram Derived Addressï¼‰ç”Ÿæˆçš„ï¼ˆæˆ–è€…ç¨‹åºæœ¬èº«æ²¡æœ‰è¿™ä¸ªè´¦æˆ·çš„ç§é’¥ï¼‰ï¼Œé‚£ä¹ˆå®ƒæ— æ³•ä»¥å¸¸è§„æ–¹å¼ç­¾åã€‚è¿™æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨ <code>invoke_signed</code> æ¥â€œæ¨¡æ‹Ÿâ€è¯¥è´¦æˆ·çš„ç­¾åï¼Œæ–¹æ³•æ˜¯ä¼ å…¥æ­£ç¡®çš„ç§å­ï¼ˆseedsï¼‰å’Œ bump å€¼ï¼Œä»¥è¯æ˜ä½ æœ‰æƒä»£è¡¨è¯¥è´¦æˆ·ç­¾åã€‚</li>
<li>å³ä½¿åœ¨ä½ çš„ä¾‹å­ä¸­ç§å­æ•°ç»„æ˜¯ç©ºçš„ï¼ˆå¯èƒ½ mint_account ä¸æ˜¯ PDAï¼Œæˆ–è€…åªæ˜¯ä¸ºäº†æ»¡è¶³æ¥å£è¦æ±‚ï¼‰ï¼Œä½ ä»ç„¶ç”¨ <code>invoke_signed</code> å‘Šè¯‰è¿è¡Œæ—¶â€œè¿™é‡Œéœ€è¦ä¸€ä¸ªâ€˜ä»£ç­¾â€™è°ƒç”¨â€ï¼Œè¿™ç§è°ƒç”¨æ–¹å¼å¯ä»¥å…è®¸ç¨‹åºä¸ºæŸä¸ªè´¦æˆ·æä¾›ç­¾åæƒé™ï¼ˆé€šå¸¸ç”¨äº PDAï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p>æ€»ç»“ï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€ä¸ª <code>invoke</code> è°ƒç”¨ï¼ˆåˆ›å»ºè´¦æˆ·ï¼‰</strong>ï¼šåªéœ€è¦ä»˜æ¬¾è´¦æˆ·ç­¾åï¼Œæ–°è´¦æˆ·è¿˜ä¸éœ€è¦ç­¾åï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨ <code>invoke</code> å°±è¡Œã€‚</li>
<li><strong>ç¬¬äºŒä¸ª <code>invoke_signed</code> è°ƒç”¨ï¼ˆåˆå§‹åŒ– Mintï¼‰</strong>ï¼šéœ€è¦ mint_account ä½œä¸ºç­¾åæ–¹ï¼Œä½†ç¨‹åºé€šå¸¸æ²¡æœ‰å®ƒçš„ç§é’¥ï¼ˆä¾‹å¦‚ mint_account å¯èƒ½æ˜¯ PDAï¼‰ï¼Œå› æ­¤ä½¿ç”¨ <code>invoke_signed</code> æ¥æä¾›â€œä¼ªç­¾åâ€ï¼ˆä½¿ç”¨ç§å­ï¼‰ï¼Œæ»¡è¶³ SPL Token ç¨‹åºçš„è¦æ±‚ã€‚</li>
</ul>
<p>è¿™ç§åšæ³•ç¡®ä¿åœ¨åˆå§‹åŒ– Mint è´¦æˆ·æ—¶ï¼Œè¿è¡Œæ—¶èƒ½å¤ŸéªŒè¯å¹¶å…è®¸ mint_account çš„â€œç­¾åâ€ï¼Œä»è€Œæ­£ç¡®åˆå§‹åŒ–è¯¥è´¦æˆ·ã€‚</p>
<h2 id="è¿è¡ŒéªŒè¯"><a href="#è¿è¡ŒéªŒè¯" class="headerlink" title="è¿è¡ŒéªŒè¯"></a>è¿è¡ŒéªŒè¯</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">solana-test-validator</span><br><span class="line">solana logs</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨åˆçº¦å…ˆéƒ¨ç½²åˆçº¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cargo build-bpf(æˆ‘ä½¿ç”¨</span><br><span class="line">cargo build-sbf</span><br><span class="line">æ‰èƒ½æˆåŠŸ)</span><br><span class="line">solana program deploy </span><br></pre></td></tr></table></figure>

<p>ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# solana program deploy /home/class/solanapractical/solana1/target/sbf-solana-solana/release/token.so</span><br><span class="line">Program Id: 8tKktQFVgGKkjhxmqo3E8CMvFSjhEmE3KwFkkjqYPVv8</span><br><span class="line"></span><br><span class="line">Signature: 4g9mi4cg9N5XbhZnQm3yDwpBrhL7opCtpANkExGuBiGT1QkdH9Cuikf4y3nrtYxoqGSZyovhUZkZUJ5NSwyG3ejF</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œtest</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Transaction executed in slot 96107:</span><br><span class="line">  Signature: 3NWo1iVWQSARR8TKMVyERCgTNDt3kczzJCS8sNnq6zLAFELbBjLMf9NLtaGSJw91a2r638AVh3EHp2NaWhXx6r43</span><br><span class="line">  Status: Ok</span><br><span class="line">  Log Messages:</span><br><span class="line">    Program 8tKktQFVgGKkjhxmqo3E8CMvFSjhEmE3KwFkkjqYPVv8 invoke [1]</span><br><span class="line">    Program log: Creating mint account...</span><br><span class="line">    Program log: Mint account is EyMbjz6bD4Hv1ehitkC8oMyrfN3Nf13PpJtGqjSMMpQo</span><br><span class="line">    Program 11111111111111111111111111111111 invoke [2]</span><br><span class="line">    Program 11111111111111111111111111111111 success</span><br><span class="line">    Program log: initialize_mint account...</span><br><span class="line">    Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA invoke [2]</span><br><span class="line">    Program log: Instruction: InitializeMint</span><br><span class="line">    Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA consumed 2920 of 182259 compute units</span><br><span class="line">    Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA success</span><br><span class="line">    Program log: SPL Token Mint  create success</span><br><span class="line">    Program 8tKktQFVgGKkjhxmqo3E8CMvFSjhEmE3KwFkkjqYPVv8 consumed 20954 of 200000 compute units</span><br><span class="line">    Program 8tKktQFVgGKkjhxmqo3E8CMvFSjhEmE3KwFkkjqYPVv8 success</span><br></pre></td></tr></table></figure>

<p>å»æµè§ˆå™¨çœ‹æ˜¯å¦å®Œå…¨æˆåŠŸ</p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>sysvar::{Sysvar,rent::Rent}</p>
<p>use spl_token::state::Mint;</p>
<p>invokeä¸­ä¼ å…¥è´¦æˆ·é¡ºåº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">invoke(</span><br><span class="line">    &amp;system_instruction::create_account(</span><br><span class="line">        payer.key, </span><br><span class="line">        mint_account.key, </span><br><span class="line">        (Rent::get()?).minimum_balance(Mint::LEN), </span><br><span class="line">        Mint::LEN as u64, </span><br><span class="line">        token_program.key,</span><br><span class="line">    ), </span><br><span class="line">    &amp;[</span><br><span class="line">        //æ¢äº†é¡ºåº</span><br><span class="line">        payer.clone(),</span><br><span class="line">        mint_account.clone(),</span><br><span class="line">    </span><br><span class="line">        system_program.clone(),</span><br><span class="line">        token_program.clone(),</span><br><span class="line">    ],</span><br><span class="line">)?; </span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡é‡æ–°éƒ¨ç½²åéƒ½è¦æŠŠæ–°çš„åˆçº¦åœ°å€å¡«ä¸Š</p>
<h3 id="accountinfo"><a href="#accountinfo" class="headerlink" title="accountinfo"></a>accountinfo</h3><p>éœ€è¦çš„è´¦æˆ·ä¸€ä¸ªä¸ªçœ‹æŒ‡ä»¤å’¯ï¼Œè¦ä¸å°±ç†Ÿæ‚‰</p>
<h1 id="ç¤¾äº¤é¡¹ç›®"><a href="#ç¤¾äº¤é¡¹ç›®" class="headerlink" title="ç¤¾äº¤é¡¹ç›®"></a>ç¤¾äº¤é¡¹ç›®</h1><p>åŠŸèƒ½å®ç°</p>
<p>å…³æ³¨ï¼Œå–æ¶ˆå…³æ³¨ï¼ŒæŸ¥è¯¢å…³æ³¨åˆ—è¡¨ï¼Œå‘å¸–ï¼ŒæŸ¥è¯¢å‘å¸–</p>
<p>cliå®¢æˆ·ç«¯è®¿é—®åˆçº¦</p>
<p>friendæ˜¯åç«¯å†™åˆçº¦</p>
<h1 id="Solanaåè®®å’Œæ ‡å‡†åº“"><a href="#Solanaåè®®å’Œæ ‡å‡†åº“" class="headerlink" title="Solanaåè®®å’Œæ ‡å‡†åº“"></a>Solanaåè®®å’Œæ ‡å‡†åº“</h1><p>åè®®æ˜¯åœ¨å…¬é“¾æˆ–è€…æŸä¸ªdappåœ¨åˆå§‹åŒ–çš„æ—¶å€™æœ‰ä¸€å¥—è‡ªå·±çš„è§„åˆ™ï¼Œæ˜¯å·²ç»æ—¢å®šå¥½çš„æ ‡å‡†åº“ï¼Œç»™å…¬é“¾å’Œå¼€å‘è€…é€šè¿‡æ ‡å‡†çš„æ¨¡å¼è¿›è¡Œæ¥å£å’ŒSDKçš„å¯¹æ¥</p>
<p>ä¸­æœ¬èªåè®®ï¼Œæ¯”ç‰¹å¸åˆ›ä¸–å‘è¡Œçš„æ—¶å€™å¾—æœ‰ä¸€å¥—åŸºç¡€çš„è§„åˆ™ï¼Œåœ¨ä¸»ç½‘ä¸Šçº¿åä¸èƒ½è¿›è¡Œä¿®æ”¹</p>
<p>åŸºæœ¬çš„æ ‡å‡†åº“ï¼Œä»¥å¤ªåŠçš„ERC-20,ERC-721,-1599.</p>
<p>SPL-tokenï¼Œspl-associated-token,memo,name service,swap,staking,govermance,flash loans,spl-token-2022ä»£å¸å†»ç»“å’Œé”å®š</p>
<h1 id="DEFIé¡¹ç›®æ‹†è§£"><a href="#DEFIé¡¹ç›®æ‹†è§£" class="headerlink" title="DEFIé¡¹ç›®æ‹†è§£"></a>DEFIé¡¹ç›®æ‹†è§£</h1><p>åŸºç¡€æ¦‚å¿µï¼Œraydiumä»£ç è§£æ</p>
<h1 id="anchorå…¥é—¨"><a href="#anchorå…¥é—¨" class="headerlink" title="anchorå…¥é—¨"></a>anchorå…¥é—¨</h1><p>åˆ›å»ºanchoré¡¹ç›®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor init &lt;new-workspace-name&gt;</span><br></pre></td></tr></table></figure>

<p>app:é»˜è®¤ä¸ºç©ºï¼Œæ”¾å‰ç«¯ä»£ç </p>
<p>programsï¼šåˆçº¦ä»£ç ã€‚é»˜è®¤æœ‰ä¸€ä¸ªé¡¹ç›®åŒåæ–‡ä»¶å¤¹ï¼Œå†…æœ‰lib.rsæ–‡ä»¶</p>
<p>testsï¼šæµ‹è¯•ï¼Œé»˜è®¤æœ‰ä¸€ä¸ªé¡¹ç›®åŒåæµ‹è¯•</p>
<p>migrationæ˜¯ï¼šåˆçº¦çš„éƒ¨ç½²ï¼Œè¿ç§»è„šæœ¬</p>
<p>anchor.toml:<br>    programs.localnetæœ¬åœ°åˆçº¦åœ°å€</p>
<p>â€‹	registryåˆçº¦ä»“åº“</p>
<p>â€‹	provider solanaç½‘ç»œ</p>
<p>â€‹	scripts è„šæœ¬</p>
<p>â€‹	ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor run &lt;script_name&gt;</span><br></pre></td></tr></table></figure>

<p>é»˜è®¤æ˜¯testè„šæœ¬</p>
<h2 id="programä»£ç "><a href="#programä»£ç " class="headerlink" title="programä»£ç "></a>programä»£ç </h2><p><strong>å£°æ˜åˆçº¦åœ°å€</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">declare_id!(&quot;4xRbvTamCW228GL1ScL99LZFzpJfkQqEEVf6QviWmSFK&quot;);</span><br></pre></td></tr></table></figure>

<p>å’Œanchor.tomlé‡Œçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[programs.localnet]</span><br><span class="line">counter = &quot;4xRbvTamCW228GL1ScL99LZFzpJfkQqEEVf6QviWmSFK&quot;</span><br></pre></td></tr></table></figure>

<p><strong>å£°æ˜åˆçº¦éœ€è¦çš„è´¦æˆ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#[derive(Accounts)]</span><br><span class="line">pub struct Initialize &#123;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pub struct Initialize &lt;&#x27;info&gt;&#123;</span><br><span class="line">    pub payer: Signer&lt;&#x27;info&gt;,</span><br><span class="line">&#125;äº¤æ˜“éœ€è¦ä¸€ä¸ªç­¾åè€…ï¼šè°è°ƒç”¨äº†è¿™ä¸ªæŒ‡ä»¤</span><br></pre></td></tr></table></figure>

<p><strong>è‡ªå®šä¹‰åˆçº¦</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#[derive(Accounts)]</span><br><span class="line">pub struct Initialize &lt;&#x27;info&gt;&#123;</span><br><span class="line">    #[account(mut)]</span><br><span class="line">    pub payer: Signer&lt;&#x27;info&gt;,</span><br><span class="line">    #[</span><br><span class="line">        account(</span><br><span class="line">            init,</span><br><span class="line">            payer = payer,</span><br><span class="line">            space = 8 + 8,</span><br><span class="line">        )</span><br><span class="line">    ]</span><br><span class="line">    pub counter: Account&lt;&#x27;info,Counter&gt;,</span><br><span class="line">    pub system_program: Program&lt;&#x27;info, System&gt;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡Œçš„spaceä¸­ï¼Œå…ˆ8+æ˜¯ <strong>Anchor è‡ªåŠ¨åˆ†é…çš„ 8 å­—èŠ‚è´¦æˆ·å¤´éƒ¨</strong>ï¼ˆç”¨äºå­˜å‚¨è´¦æˆ·çš„ <code>discriminator</code>ï¼‰ã€‚è‡³å°‘éœ€è¦8ä¸ªå­—èŠ‚ï¼Œç”±å› ä¸ºCounteréœ€è¦å­˜å‚¨ä¸€ä¸ªu64çš„æ•°ï¼Œéœ€è¦8ä¸ªå­—èŠ‚</p>
<p><strong>ç¼–è¯‘</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor build</span><br></pre></td></tr></table></figure>

<p><strong>éƒ¨ç½²</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor deploy</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°targeté‡Œçš„.soå¯æ‰§è¡Œæ–‡ä»¶åœ¨deployï¼Œå…¶ä¸­idlæè¿°åˆçº¦çš„æŒ‡ä»¤ï¼Œåˆ©ç”¨idlå¯ä»¥è¿›è¡Œtestsçš„ç¼–å†™</p>
<p><strong>åœ¨testsä¸­</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const program = anchor.workspace.Counter as Program&lt;Counter&gt;;</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°åˆçº¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const counterKeypair = new anchor.web3.Keypair();</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªæ–°åœ°å€ï¼Œä¼ è¿‡æ¥çš„åœ°å€ï¼Œanchorç¨‹åºçš„æ¡†æ¶éƒ½ä¼šå¸®æˆ‘ä»¬åˆå§‹åŒ–å¥½ï¼Œä¾æ®lib.rsé‡Œå·²ç»å†™å¥½çš„ç¨‹åº</p>
<p><strong>è¿è¡Œ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor run test</span><br></pre></td></tr></table></figure>



<h2 id="pdaçš„æ¦‚å¿µ"><a href="#pdaçš„æ¦‚å¿µ" class="headerlink" title="pdaçš„æ¦‚å¿µ"></a>pdaçš„æ¦‚å¿µ</h2><p>pdaï¼šç¨‹åºæ´¾ç”Ÿè´¦æˆ·</p>
<p>pdaçš„ä½¿ç”¨åœºæ™¯ï¼šæ¯ä¸ªäººæœ‰ä¸€ä¸ªä¸åŒçš„è®¡æ—¶å™¨</p>
<p>1.web2ä¸­å¸¸ç”¨ï¼Œä½¿ç”¨hashmap&lt;pubkey, 0&gt;;</p>
<p>ç¼ºç‚¹ï¼šè´¦æˆ·æœ‰10mbå¤§å°çš„é™åˆ¶</p>
<p>dappå½“æŸ¥è¯¢æŸä¸€ä¸ªäººçš„è®¡æ—¶å™¨éœ€è¦æ‹‰å–å…¨éƒ¨æ•°æ®</p>
<p>2.ç‹¬ç«‹è´¦æˆ·</p>
<p>éœ€è¦è®°å½•é’±åŒ…å’Œè´¦æˆ·çš„æ˜ å°„å…³ç³»</p>
<p>3.pda</p>
<p>ä¸éœ€è¦è®°å½•é’±åŒ…å’Œè´¦æˆ·çš„æ˜ å°„å…³ç³»ï¼Œæ¯ä¸ªè´¦æˆ·ç‹¬ç«‹ä¸”ä¸ä¼šå†²çª</p>
<p>CPI</p>
<h2 id="é—®é¢˜-1"><a href="#é—®é¢˜-1" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="1-account-data-too-small"><a href="#1-account-data-too-small" class="headerlink" title="1.account data too small"></a>1.account data too small</h3><p>solanaéƒ¨ç½²ä¸­ä¼šæŒ‰ç…§ä¸¤å€çš„å®¹é‡é¢„ç•™ï¼Œç¨‹åºæ‰©å¤§çš„è¯ç©ºé—´å¯èƒ½ä¼šä¸å¤Ÿå¤§ï¼Œå¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solana program extend &lt;åˆçº¦åœ°å€&gt; &lt;æ‰©å……å­—èŠ‚æ•°&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-Error-unknown-signer"><a href="#2-Error-unknown-signer" class="headerlink" title="2.Error: unknown signer:"></a>2.Error: unknown signer:</h3><p>E8sCqmMYGqwF3KsP9UNFwMmexMBTHhju6Ha3yTXQ9FBP</p>
<p>è¿™ç§æƒ…å†µä¸€èˆ¬éƒ½æ˜¯å› ä¸ºå­˜å…¥çš„è´¦å·ä¸å¤Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">export async function craeteLike( </span><br><span class="line">    wallet:anchor.Wallet,</span><br><span class="line">    tweetPda: anchor.web3.PublicKey,</span><br><span class="line">) &#123;</span><br><span class="line">    return await program.methods.creatLike().accounts(&#123;</span><br><span class="line">        tweet:tweetPda,</span><br><span class="line">    &#125;).signers([wallet.payer])</span><br><span class="line">    .rpc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡Œçš„accountsä¸å¤Ÿ</p>
<h3 id="3-accountnotdeserialize"><a href="#3-accountnotdeserialize" class="headerlink" title="3.accountnotdeserialize"></a>3.accountnotdeserialize</h3><p>spaceé‡Œä¸è¦å¿˜è®°åŠ 8å­—èŠ‚</p>
<h2 id="4-tokenmetadataåˆçº¦ä¸æ˜¯å¯æ‰§è¡Œçš„è´¦æˆ·"><a href="#4-tokenmetadataåˆçº¦ä¸æ˜¯å¯æ‰§è¡Œçš„è´¦æˆ·" class="headerlink" title="4.tokenmetadataåˆçº¦ä¸æ˜¯å¯æ‰§è¡Œçš„è´¦æˆ·"></a>4.tokenmetadataåˆçº¦ä¸æ˜¯å¯æ‰§è¡Œçš„è´¦æˆ·</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: AnchorError caused by account: token_metadata_program. Error Code: InvalidProgramExecutable. Error Number: 3009. Error Message: Program account is not executable.</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºtokenmetadataä¸æ˜¯å®˜æ–¹éƒ¨ç½²çš„ï¼Œåœ¨å¼€å‘ç¯å¢ƒæ˜¯æ²¡æœ‰åˆçº¦ï¼Œåœ¨æµ‹è¯•ç½‘ç»œä¸Š</p>
<p>å¯ä»¥æŠŠæµ‹è¯•ç½‘ç»œçš„åˆçº¦å¤åˆ¶åˆ°æœ¬åœ°ç½‘ç»œ</p>
<h2 id="è´¦æˆ·çš„æ¦‚å¿µ"><a href="#è´¦æˆ·çš„æ¦‚å¿µ" class="headerlink" title="è´¦æˆ·çš„æ¦‚å¿µ"></a>è´¦æˆ·çš„æ¦‚å¿µ</h2><p>solanaä¸­ä¸€åˆ‡çš„æ•°æ®éƒ½å¯ä»¥è¢«ç§°ä¸ºè´¦æˆ·</p>
<p>accountinfo:data,executable,lamports,owner</p>
<p>åŸç”Ÿåˆçº¦</p>
<p>1ï¼šBPF Loader(è‡ªå®šä¹‰åˆçº¦)ï¼šåˆçº¦æ•°æ®ï¼Œowneréƒ½ä¼šè®¾ç½®æˆBPF Loaderã€‚å¯¹äºè‡ªå®šä¹‰åˆçº¦æ¥è¯´ï¼Œdataç›®æ ‡æ‰§è¡Œçš„æ–‡ä»¶å’Œä»£ç ï¼Œexecutable is trueã€‚å­˜å‚¨æ•°æ®å¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œæ¥å­˜å‚¨åˆçº¦éœ€è¦çš„æ•°æ®ï¼Œè¯¥è´¦æˆ·çš„owneræŒ‡å‘è‡ªå®šä¹‰åˆçº¦ã€‚</p>
<p>2.ï¼šsystem programç³»ç»Ÿåˆçº¦:é’±åŒ…è´¦æˆ·ï¼Œownerè®¾ç½®æˆç³»ç»Ÿåˆçº¦</p>
<h1 id="å°çš„anchoré¡¹ç›®Socialé¡¹ç›®"><a href="#å°çš„anchoré¡¹ç›®Socialé¡¹ç›®" class="headerlink" title="å°çš„anchoré¡¹ç›®Socialé¡¹ç›®"></a>å°çš„anchoré¡¹ç›®Socialé¡¹ç›®</h1><p>ç±»ä¼¼äºæ¨ç‰¹çš„åŠŸèƒ½ï¼Œå¯ä»¥æ³¨å†Œç”¨æˆ·ï¼Œå‘å¸ƒå¸–å­ï¼Œç»™å¸–å­ç‚¹èµï¼Œspl-tokenï¼Œç‚¹èµçš„æ—¶å€™ä½œè€…ä¼šæ”¶åˆ°ä¸€ä¸ªtoken</p>
<p>profile:â€profileâ€ + payer </p>
<p>content: display_name:String  , tweet_count:u32</p>
<p>tweet:â€tweetâ€ + payer + count  </p>
<p>content: body:string , like_count:u32</p>
<p>like : tweet + payer +tweet</p>
<p>content: payer,  tweet</p>
<p>ç»™æ–‡ä»¶åˆ†ç±»</p>
<p>å‰ç«¯appæ–‡ä»¶è¦åŠ å…¥anchor.tomlé‡Œçš„[script]é‡Œè¿è¡Œ</p>
<p>ç‚¹èµä¹‹åmintä¸€äº›spl token ç»™åŸæ¥çš„ä½œè€…</p>
<h2 id="spl-token"><a href="#spl-token" class="headerlink" title="spl token"></a>spl token</h2><p>åœ¨ä»¥å¤ªåŠï¼Œæœ¬èº«çš„åˆçº¦æ˜¯æœ‰çŠ¶æ€çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æœ¬èº«çš„åˆçº¦ä¸­å­˜å‚¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬tokençš„æ‰€æœ‰äººä»¥åŠtokenæ¯äººçš„ä½™é¢ï¼Œæ‰€ä»¥è¦ç¼–å†™çš„å°±æ˜¯ä¸€ä¸ªtokençš„åˆçº¦ã€‚å…¶ä¸­éœ€è¦æŒ‰ç…§å„ä¸ªåŒºå—é“¾ï¼ŒICRC1ï¼ŒICRC2çš„æ ‡å‡†æ¥æä¾›æ ‡å‡†åŒ–çš„æ¥å£ï¼Œéœ€è¦å®ç°çº¦å®šå¥½çš„æ¥å£ã€‚mint,approve,transfer</p>
<p>åœ¨solanaçš„åˆçº¦ä¸­æ˜¯ä¸èƒ½å­˜å‚¨çŠ¶æ€çš„ï¼Œå­˜å‚¨çŠ¶æ€éœ€è¦å€ŸåŠ©ä¸€ä¸ªè´¦æˆ·çš„æ¦‚å¿µã€‚æˆ‘ä»¬éœ€è¦æä¾›çš„æ˜¯ä¸€ä¸ªtokençš„è´¦æˆ·</p>
<p>mint accountï¼šdecimalsï¼Œ mint_authority</p>
<p>token account: mint, authority&#x2F;owner a(jè®°å½•tokençš„ä½™é¢)</p>
<p>solanaä¸­SPL TOKENçš„è´¦æˆ·</p>
<p>authority: cpi</p>
<p>1.token program</p>
<p>æ˜¯owner</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Token Account: </span><br><span class="line">mint,authority/owner</span><br><span class="line"></span><br><span class="line">Mint Account:</span><br><span class="line">decimals,mint_authority</span><br></pre></td></tr></table></figure>

<p>2.TokenMetadata Program</p>
<p>æ˜¯owner:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Metadata Account:</span><br><span class="line">name,symbool,url,mint_authority --</span><br></pre></td></tr></table></figure>



<p><strong>system program</strong></p>
<p>æ˜¯wallet accountçš„owner</p>
<h2 id="å®é™…Splæ­¥éª¤"><a href="#å®é™…Splæ­¥éª¤" class="headerlink" title="å®é™…Splæ­¥éª¤"></a>å®é™…Splæ­¥éª¤</h2><p>å…ˆåˆ›å»ºmint account,å†æŠŠownerè½¬ç»™token programã€‚</p>
<p>ä½¿ç”¨pdaåˆ›å»ºä¸€ä¸ªmetadata accountï¼ŒåŒæ—¶æŠŠownerè½¬ç»™tokenmetadata programã€‚</p>
<p>æ‹¥æœ‰mint accountä¹‹åå¯ä»¥è¿›è¡Œmint æ“ä½œï¼Œè°ƒç”¨çš„æ˜¯token programï¼ŒåŒæ—¶ä¸ºå…¶æä¾›ä¸€ä¸ªtoken accountï¼Œå…¶ownerä¹Ÿæ˜¯token programã€‚åŒæ—¶token accountä¹Ÿæ˜¯æ ¹æ®mint accountå’Œwallet accountç”Ÿæˆçš„pdaï¼Œæ‰€ä»¥å…¶å¯¹äºè´¦æˆ·açš„æŸä¸ªä»£å¸è´¦æˆ·æ¥è¯´æ˜¯å”¯ä¸€çš„</p>
<p><strong>ç”Ÿæˆspl-token</strong></p>
<p>1.é€šè¿‡å‘½ä»¤è¡Œ</p>
<p>2.ruståŸç”Ÿåº“</p>
<p>3.anchor</p>
<p>MINTéœ€è¦å¼•å…¥anchor-splçš„åº“ï¼Œåœ¨buildçš„æ—¶å€™éœ€è¦buildå‡ºsplçš„build</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">idl-build = [&quot;anchor-lang/idl-build&quot;,&quot;anchor-spl/idl-build&quot;]</span><br><span class="line">è¿™æ ·æ‰èƒ½ç¼–è¯‘å‡ºsplçš„ä»£ç </span><br><span class="line">[dependencies]</span><br><span class="line">anchor-lang = &quot;0.30.1&quot;</span><br><span class="line">anchor-spl = &#123;version = &quot;0.30.1&quot;,features = [&quot;metadata&quot;]&#125;</span><br></pre></td></tr></table></figure>

<p>anchor-spl 0.31.1</p>
<p>metadataçš„seedså¿…é¡»æ˜¯metadataã€‚ã€‚å¼•å…¥è¿˜æ²¡æï¼Œå¥‡æ€ªï¼Œä¸Šé¢æ²¡æœ‰</p>
<p>åˆ›å»ºtokenè´¦æˆ·çš„æ–¹å¼å«å…³è”è´¦æˆ·</p>
<p>çœ‹token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token accounts</span><br></pre></td></tr></table></figure>



<h1 id="è´¨æŠ¼"><a href="#è´¨æŠ¼" class="headerlink" title="è´¨æŠ¼"></a>è´¨æŠ¼</h1><p><strong>1.ç½‘ç»œçº§åˆ«çš„è´¨æŠ¼ï¼ˆStaking for netwrok securityï¼‰</strong></p>
<p>solanaå®˜æ–¹å¼€å‘çš„åˆçº¦</p>
<p><strong>(1)Native Staking on solana:</strong></p>
<p>åŸç”Ÿçš„åˆçº¦å·²ç»éƒ¨ç½²åœ¨äº†solanaçš„ç½‘ç»œä¸­</p>
<p>stake account, validator</p>
<p><strong>(2)Liquid Staking:Stake Pools</strong></p>
<p>Validator list account:éªŒè¯èŠ‚ç‚¹åˆ—è¡¨</p>
<p>Stake Pool: </p>
<p>Mint Account (liquidity token æ˜¯è´¨æŠ¼çš„å‡­è¯)</p>
<p>Reserve stake account: ç”¨äºæŒæœ‰æœªæˆæƒçš„è´¨æŠ¼</p>
<p><strong>2.åº”ç”¨çº§åˆ«çš„è´¨æŠ¼ï¼ˆApplication-Level Stakingï¼‰</strong></p>
<h3 id="è´¨æŠ¼æ”¶ç›Šæ¨¡å‹"><a href="#è´¨æŠ¼æ”¶ç›Šæ¨¡å‹" class="headerlink" title="è´¨æŠ¼æ”¶ç›Šæ¨¡å‹"></a><strong>è´¨æŠ¼æ”¶ç›Šæ¨¡å‹</strong></h3><p>è¿™ä¸¤ä¸ªå…¬å¼ç”¨äºè®¡ç®— <strong>Solana è´¨æŠ¼ï¼ˆStakingï¼‰æ”¶ç›Šç‡</strong>ï¼Œå…¶ä¸­æ¶‰åŠé€šèƒ€ã€éªŒè¯è€…åœ¨çº¿ç‡ã€éªŒè¯è€…è´¹ç”¨ä»¥åŠå·²è´¨æŠ¼çš„SOLæ¯”ä¾‹ã€‚ä¸‹é¢æ˜¯è¯¦ç»†è§£é‡Šï¼š</p>
<p><strong>å…¬å¼1ï¼šStaking Yieldï¼ˆè´¨æŠ¼æ”¶ç›Šç‡ï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Staking Yield=InflationÃ—Validator UptimeÃ—(1âˆ’Validator Fee)%SOL Staked\text&#123;Staking Yield&#125; = \frac&#123;\text&#123;Inflation&#125; \times \text&#123;Validator Uptime&#125; \times (1 - \text&#123;Validator Fee&#125;)&#125;&#123;\% \text&#123;SOL Staked&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥å…¬å¼è®¡ç®— <strong>è´¨æŠ¼SOLçš„å¹´åŒ–æ”¶ç›Šç‡</strong>ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><strong>Staking Yieldï¼ˆè´¨æŠ¼æ”¶ç›Šç‡ï¼‰</strong>ï¼šæŒ‡æŒæœ‰è€…è´¨æŠ¼SOLåï¼Œæ¯å¹´èƒ½è·å¾—çš„æ”¶ç›Šç‡ï¼ˆé€šå¸¸ä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰ã€‚</li>
<li><strong>Inflationï¼ˆé€šèƒ€ç‡ï¼‰</strong>ï¼šSolana ç½‘ç»œæ¯å¹´çš„ <strong>SOL å¢å‘ç‡</strong>ï¼Œè¿™å†³å®šäº†å¯åˆ†é…ç»™éªŒè¯è€…å’Œè´¨æŠ¼è€…çš„å¥–åŠ±æ€»é‡ã€‚</li>
<li><strong>Validator Uptimeï¼ˆéªŒè¯è€…åœ¨çº¿ç‡ï¼‰</strong>ï¼šéªŒè¯è€…ï¼ˆValidatorï¼‰çš„ <strong>è¿è¡Œæ—¶é—´å æ¯”</strong>ï¼Œå¦‚æœéªŒè¯è€…ç»å¸¸æ‰çº¿ï¼Œå…¶è´¨æŠ¼è€…çš„å¥–åŠ±ä¹Ÿä¼šå‡å°‘ã€‚</li>
<li><strong>Validator Feeï¼ˆéªŒè¯è€…è´¹ç”¨ï¼‰</strong>ï¼šéªŒè¯è€…ä¼šæ”¶å–ä¸€éƒ¨åˆ†å¥–åŠ±ä½œä¸º <strong>è¿è¥è´¹ç”¨</strong>ï¼Œè¿™éƒ¨åˆ†ä¸ä¼šåˆ†é…ç»™è´¨æŠ¼è€…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœFee&#x3D;5%ï¼Œåˆ™åªæœ‰ 95% çš„å¥–åŠ±ä¼šåˆ†é…ç»™å§”æ‰˜è€…ï¼ˆStakerï¼‰ã€‚</li>
<li><strong>% SOL Stakedï¼ˆå·²è´¨æŠ¼çš„SOLæ¯”ä¾‹ï¼‰</strong>ï¼šæ•´ä¸ªSolanaç½‘ç»œä¸­è¢«è´¨æŠ¼çš„SOLå æ€»ä¾›åº”é‡çš„æ¯”ä¾‹ã€‚å¦‚æœæ›´å¤šSOLè¢«è´¨æŠ¼ï¼Œæ¯ä¸ªè´¨æŠ¼è€…è·å¾—çš„ä»½é¢å°±ä¼šå‡å°‘ã€‚</li>
</ul>
<p>è¯¥å…¬å¼è¡¨æ˜ï¼Œ<strong>SOLè´¨æŠ¼æ”¶ç›Šç‡å—ä»¥ä¸‹å› ç´ å½±å“</strong>ï¼š</p>
<ol>
<li><strong>é€šèƒ€ç‡ï¼ˆInflationï¼‰è¶Šé«˜</strong>ï¼Œæ”¶ç›Šç‡è¶Šé«˜ã€‚</li>
<li><strong>éªŒè¯è€…åœ¨çº¿ç‡ï¼ˆValidator Uptimeï¼‰è¶Šé«˜</strong>ï¼Œæ”¶ç›Šç‡è¶Šé«˜ã€‚</li>
<li><strong>éªŒè¯è€…è´¹ç”¨ï¼ˆValidator Feeï¼‰è¶Šä½</strong>ï¼Œæ”¶ç›Šç‡è¶Šé«˜ã€‚</li>
<li><strong>ç½‘ç»œä¸Šè´¨æŠ¼çš„SOLæ¯”ä¾‹ï¼ˆ% SOL Stakedï¼‰è¶Šé«˜</strong>ï¼Œæ”¶ç›Šç‡è¶Šä½ï¼ˆå› ä¸ºå¥–åŠ±è¦åˆ†ç»™æ›´å¤šçš„è´¨æŠ¼è€…ï¼‰ã€‚</li>
</ol>
<hr>
<p><strong>å…¬å¼2ï¼š% SOL Stakedï¼ˆå·²è´¨æŠ¼çš„SOLæ¯”ä¾‹ï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%SOL Staked=Total SOL StakedTotal Current Supply\% \text&#123;SOL Staked&#125; = \frac&#123;\text&#123;Total SOL Staked&#125;&#125;&#123;\text&#123;Total Current Supply&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è¯¥å…¬å¼è®¡ç®—ç½‘ç»œä¸­<strong>å½“å‰æœ‰å¤šå°‘SOLè¢«è´¨æŠ¼</strong>ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><strong>% SOL Stakedï¼ˆå·²è´¨æŠ¼SOLæ¯”ä¾‹ï¼‰</strong>ï¼šç½‘ç»œä¸­è¢«è´¨æŠ¼çš„SOLå  <strong>æ€»ä¾›åº”é‡</strong> çš„æ¯”ä¾‹ï¼ˆä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰ã€‚</li>
<li><strong>Total SOL Stakedï¼ˆå·²è´¨æŠ¼çš„SOLæ€»é‡ï¼‰</strong>ï¼šæ‰€æœ‰ç”¨æˆ·è´¨æŠ¼åˆ°éªŒè¯è€…çš„SOLæ€»æ•°ã€‚</li>
<li><strong>Total Current Supplyï¼ˆå½“å‰SOLæ€»ä¾›åº”é‡ï¼‰</strong>ï¼šSolanaç½‘ç»œçš„ <strong>å½“å‰æ€»ä¾›åº”é‡</strong>ï¼ŒåŒ…æ‹¬æœªè´¨æŠ¼å’Œå·²è´¨æŠ¼çš„SOLã€‚</li>
</ul>
<p>è¿™ä¸ªå…¬å¼åæ˜ äº†<strong>ç½‘ç»œä¸­SOLçš„è´¨æŠ¼ç‡</strong>ï¼Œè´¨æŠ¼ç‡é«˜ä¼šå½±å“è´¨æŠ¼æ”¶ç›Šï¼ˆ<strong>æ›´å¤šäººåˆ†äº«å¥–åŠ±ï¼Œå•ä¸ªè´¨æŠ¼è€…æ”¶ç›Šé™ä½</strong>ï¼‰ã€‚</p>
<hr>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li><strong>Staking Yield è®¡ç®—çš„æ˜¯æ¯å¹´èƒ½èµšå¤šå°‘</strong>ï¼Œå®ƒç”±é€šèƒ€ã€éªŒè¯è€…è¡¨ç°ã€è´¹ç”¨å’Œç½‘ç»œä¸­å·²è´¨æŠ¼çš„æ¯”ä¾‹å†³å®šã€‚</li>
<li><strong>% SOL Staked è®¡ç®—çš„æ˜¯SOLç½‘ç»œä¸­çš„è´¨æŠ¼æ¯”ä¾‹</strong>ï¼Œå½±å“äº†å¥–åŠ±çš„åˆ†é…ã€‚</li>
<li><strong>å½“æ›´å¤šäººè´¨æŠ¼SOLæ—¶ï¼Œæ¯ä¸ªäººçš„æ”¶ç›Šç‡ä¼šé™ä½ï¼ˆç¨€é‡Šæ•ˆåº”ï¼‰</strong>ã€‚</li>
<li><strong>éªŒè¯è€…çš„åœ¨çº¿ç‡å’Œè´¹ç”¨ä¹Ÿä¼šå½±å“ä½ çš„å®é™…æ”¶ç›Š</strong>ã€‚</li>
</ol>
<p>å¦‚æœä½ æƒ³åœ¨ Solana è´¨æŠ¼ä¸­è·å¾—<strong>æ›´é«˜æ”¶ç›Š</strong>ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li><strong>é€‰æ‹©é«˜åœ¨çº¿ç‡ã€ä½è´¹ç”¨çš„éªŒè¯è€…</strong>ã€‚</li>
<li><strong>åœ¨SOLè´¨æŠ¼ç‡è¾ƒä½æ—¶è¿›å…¥</strong>ï¼Œä»¥è·å¾—æ›´é«˜æ”¶ç›Šã€‚</li>
</ul>
<p><strong>APYï¼ˆå¹´åˆ©ç‡ï¼‰</strong></p>
<p><strong>staking yield(è´¨æŠ¼æ”¶ç›Šç‡ï¼Œé€šå¸¸ä»¥ç™¾åˆ†æ¯”çš„å½¢å¼è¡¨ç¤º) &#x3D; inflationï¼ˆé€šèƒ€ç‡ï¼‰ * validator Uptimeï¼ˆéªŒè¯è€…åœ¨çº¿ç‡ï¼‰ * (1 - validator Feeï¼ˆéªŒè¯è€…è´¹ç”¨ï¼‰)&#x2F;(% sol staked),ï¼ˆå·²è´¨æŠ¼çš„SOLæ¯”ä¾‹ï¼‰</strong></p>
<p><strong>% sol stakedï¼ˆå·²è´¨æŠ¼SOLæ¯”ä¾‹ï¼‰ &#x3D; total sol stakedï¼ˆå·²è´¨æŠ¼çš„SOLæ€»é‡ï¼‰ &#x2F; total current supplyï¼ˆå½“å‰SOLæ€»ä¾›åº”é‡ï¼‰</strong></p>
<h2 id="Staking-for-netwrok-security"><a href="#Staking-for-netwrok-security" class="headerlink" title="Staking for netwrok security"></a>Staking for netwrok security</h2><p>ä½¿ç”¨æµåŠ¨æ€§è´¨æŠ¼çš„æ–¹å¼</p>
<h3 id="1-Native-Staking-on-solana"><a href="#1-Native-Staking-on-solana" class="headerlink" title="(1)Native Staking on solana:"></a><strong>(1)Native Staking on solana:</strong></h3><p>åŸç”Ÿçš„åˆçº¦</p>
<p>è§’è‰²ï¼š<br>User Wallet: ç”¨æˆ·é€šè¿‡è´¨æŠ¼è´¦æˆ·è¿›è¡Œè´¨æŠ¼</p>
<p>Validatorï¼š validator é€šè¿‡vote accountæ¥æ”¶è´¨æŠ¼</p>
<p><strong>æ­¥éª¤</strong></p>
<p>user wallet account -&gt;</p>
<p>(owner staking program)stake account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stake authority address</span><br><span class="line">withdraw authority address</span><br><span class="line">lockup authority address</span><br><span class="line">delegated vote address</span><br></pre></td></tr></table></figure>

<p>-&gt;vote account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">validator identity</span><br><span class="line">vote authority</span><br><span class="line">withdraw authority</span><br><span class="line">owner</span><br></pre></td></tr></table></figure>

<p>æŠŠsolè½¬ç§»åˆ°stake account,ç„¶åæŠŠè´¨æŠ¼è´¦æˆ·è´¨æŠ¼ç»™ä¸€ä¸ªvalidatorï¼Œvalidatoré€šè¿‡vote accountæ¥æ”¶è´¨æŠ¼</p>
<p>ä¸€æ˜¯æˆä¸ºvalidatorèŠ‚ç‚¹è·å–æ”¶ç›Š</p>
<p>äºŒæ˜¯ä½œä¸ºç”¨æˆ·ä¾§æŠŠsolè¿›è¡Œè´¨æŠ¼</p>
<h4 id="1-ä½¿ç”¨é’±åŒ…"><a href="#1-ä½¿ç”¨é’±åŒ…" class="headerlink" title="1.ä½¿ç”¨é’±åŒ…"></a>1.ä½¿ç”¨é’±åŒ…</h4><p>phantom å’Œ solflareéƒ½åŸç”Ÿæ”¯æŒè´¨æŠ¼</p>
<h4 id="2-ä½¿ç”¨solana-cli-é€šè¿‡å‘½ä»¤è¡Œè´¨æŠ¼"><a href="#2-ä½¿ç”¨solana-cli-é€šè¿‡å‘½ä»¤è¡Œè´¨æŠ¼" class="headerlink" title="2.ä½¿ç”¨solana cli é€šè¿‡å‘½ä»¤è¡Œè´¨æŠ¼"></a>2.ä½¿ç”¨solana cli é€šè¿‡å‘½ä»¤è¡Œè´¨æŠ¼</h4><p><strong>1.åˆ›å»ºè´¨æŠ¼è´¦æˆ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">solana-keygen new --no-passphrase -s -o stake-account.json </span><br><span class="line"></span><br><span class="line">solana create-stake-account stake-account.json 100 </span><br><span class="line">    # --url localhost</span><br><span class="line">    # --stake-authority wallet.json --withdraw-authority wallet.json \</span><br><span class="line">    # --from wallet.json \</span><br><span class="line">    # --fee-payer wallet.json \</span><br><span class="line"></span><br><span class="line">solana stake-account stake-account.json</span><br></pre></td></tr></table></figure>

<ul>
<li><code>--stake-authority</code>: æœ‰å§”æ‰˜è´¨æŠ¼ã€æ‹†åˆ†ã€åˆå¹¶è´¨æŠ¼è´¦æˆ·æƒé™çš„key pair</li>
<li><code>--withdraw-authority</code>: æœ‰æç°æƒé™çš„key pair</li>
</ul>
<p><strong>2.è¿›è¡Œå§”æ‰˜ï¼ˆdelegateï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Vote Account </span><br><span class="line">solana validators -u localhost</span><br><span class="line"></span><br><span class="line">solana delegate-stake stake-account.json &lt;VOTE_ACCOUNT&gt;  </span><br><span class="line">    # --stake-authority wallet.json \ </span><br><span class="line">    # --fee-payer wallet.json \</span><br><span class="line">    # --url localhost</span><br><span class="line">    # --with-memo &quot;Delegating stake test.&quot;</span><br><span class="line"></span><br><span class="line">solana stake-account stake-account.json</span><br></pre></td></tr></table></figure>



<p><strong>3.å–æ¶ˆè´¨æŠ¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">solana deactivate-stake stake-account.json</span><br><span class="line">    # --stake-authority wallet.json \</span><br><span class="line">    # --fee-payer wallet.json \</span><br><span class="line">    # --url localhost \</span><br><span class="line"></span><br><span class="line">solana stake-account stake-account.json</span><br></pre></td></tr></table></figure>



<p><strong>4.æç°ï¼ˆwithdrawï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">solana withdraw-stake stake-account.json &lt;DESTINATION&gt; &lt;AMOUNT&gt;</span><br><span class="line">    # --withdraw-authority wallet.json  \</span><br><span class="line">    # --fee-payer wallet.json \</span><br><span class="line">    # --url localhost \</span><br><span class="line"></span><br><span class="line"># å…¨éƒ¨æç°åstake accountå³è¢«é”€æ¯</span><br><span class="line">solana stake-account stake-account.json</span><br></pre></td></tr></table></figure>

<h4 id="å®é™…"><a href="#å®é™…" class="headerlink" title="å®é™…"></a>å®é™…</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solana-keygen new --no-passphrase  -s -o ~/account/c1.json</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å¯†ç ï¼Œä½¿ç”¨åŠ©è®°è¯ï¼Œoutfile, åœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> cat /root/account/c1.json</span><br><span class="line">[113,197,126,28,126,137,241,219,18,32,156,28,98,212,19,223,42,212,72,61,243,167,100,114,234,68,225,136,74,63,34,216,245,119,230,181,242,128,182,165,176,194,154,131,43,217,185,81,117,98,88,173,53,225,214,121,205,128,197,190,110,0,126,216]#     </span><br></pre></td></tr></table></figure>

<p>å…¬é’¥å’Œç§é’¥çš„æ•°ç»„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">solana address -k ~/account/c1.json</span><br><span class="line">HXCvn5SjkYne2vtdkEFVqgFqGn8oqwpuCtPpQnqU6a9m</span><br></pre></td></tr></table></figure>

<p><strong>åˆ›å»ºè´¨æŠ¼è´¦æˆ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> solana create-stake-account [FLAGS] [OPTIONS] &lt;STAKE_ACCOUNT_KEYPAIR&gt; &lt;AMOUNT&gt;</span><br><span class="line"></span><br><span class="line">solana create-stake-account ~/account/c1.json 100 (--url localhost)</span><br></pre></td></tr></table></figure>

<p>åˆ›ä½œçš„stake account çš„stake authority å’Œ withdraw authorityçš„owneréƒ½æ˜¯å½“å‰ç”¨æˆ·ï¼Œè®¾ç½®çš„è´¦æˆ·&#x2F;root&#x2F;.config&#x2F;solana&#x2F;id.json</p>
<p><strong>æŸ¥çœ‹è´¨æŠ¼è´¦æˆ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solana stake-account ~/account/c1.json</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Balance: 100 SOL</span><br><span class="line">Rent Exempt Reserve: 0.00228288 SOL</span><br><span class="line">Stake account is undelegatedï¼ˆæœªå§”æ‰˜ã€è´¨æŠ¼ï¼‰</span><br><span class="line">Stake Authority: DJEniGyLz8DQCXQUshro9TwqGUWGgQ1PpYgMC9dCoNM9</span><br><span class="line">Withdraw Authority: DJEniGyLz8DQCXQUshro9TwqGUWGgQ1PpYgMC9dCoNM9</span><br></pre></td></tr></table></figure>

<p><strong>æŠŠè¯¥è´¦æˆ·è´¨æŠ¼ç»™æœ¬åœ°vote account</strong></p>
<p>æŸ¥çœ‹æœ¬åœ°validators</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solana validators -u localhost</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">å­—æ®µ	å«ä¹‰</span><br><span class="line">Identityï¼ˆèº«ä»½å…¬é’¥ï¼‰	éªŒè¯è€…çš„ èº«ä»½å…¬é’¥ï¼Œå³è¯¥éªŒè¯è€…çš„å”¯ä¸€æ ‡è¯†ã€‚</span><br><span class="line">Vote Accountï¼ˆæŠ•ç¥¨è´¦æˆ·ï¼‰	è¯¥éªŒè¯è€…çš„ æŠ•ç¥¨è´¦æˆ·åœ°å€ï¼Œç”¨äºå‚ä¸å…±è¯†ï¼ˆPoH è¯æ˜å†å²æœºåˆ¶ï¼‰ã€‚</span><br><span class="line">Commissionï¼ˆä½£é‡‘ï¼‰	è¯¥éªŒè¯è€…å¯¹å§”æ‰˜è€…çš„ æ”¶ç›ŠæŠ½æˆç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚ 0% ä»£è¡¨è¯¥éªŒè¯è€…ä¸æ”¶å–ä½£é‡‘ï¼‰ã€‚</span><br><span class="line">Last Voteï¼ˆæœ€åæŠ•ç¥¨ï¼‰	è¯¥éªŒè¯è€…æœ€è¿‘ä¸€æ¬¡æäº¤çš„ æŠ•ç¥¨ slotï¼ˆSolana çš„ slot ç±»ä¼¼äºåŒºå—é«˜åº¦ï¼‰ã€‚</span><br><span class="line">Root Slotï¼ˆæ ¹ Slotï¼‰	è¯¥éªŒè¯è€…å·²ç¡®è®¤çš„ æœ€ç¨³å®š slotï¼Œæ¯” Last Vote æ›´ç¨³å®šï¼ˆé€šå¸¸æŒ‡å·²æœ€ç»ˆç¡®è®¤çš„ slotï¼‰ã€‚</span><br><span class="line">Skip Rateï¼ˆè·³è¿‡ç‡ï¼‰	è¯¥éªŒè¯è€… æœªæˆåŠŸå¤„ç† slot çš„æ¯”ç‡ï¼Œå¦‚æœè¿‡é«˜ï¼Œè¯´æ˜å…¶æ€§èƒ½è¾ƒå·®ã€‚</span><br><span class="line">Creditsï¼ˆç§¯åˆ†ï¼‰	è¯¥éªŒè¯è€… æˆåŠŸæŠ•ç¥¨çš„ç´¯è®¡å¥–åŠ±ç§¯åˆ†ï¼Œç§¯åˆ†è¶Šé«˜ï¼Œè¯´æ˜å®ƒå¤„ç†çš„ slot è¶Šå¤šã€‚</span><br><span class="line">Versionï¼ˆç‰ˆæœ¬ï¼‰	è¯¥éªŒè¯è€…è¿è¡Œçš„ Solana ç‰ˆæœ¬ï¼ˆå¦‚ 2.1.14ï¼‰ï¼Œç‰ˆæœ¬è¶Šæ–°ï¼Œé€šå¸¸æ€§èƒ½ä¼˜åŒ–æ›´å¥½ã€‚</span><br><span class="line">Average Stake-Weighted Skip Rate	ä»¥ è´¨æŠ¼æƒé‡ è®¡ç®—çš„ å…¨ç½‘å¹³å‡è·³è¿‡ç‡ï¼ˆæ›´ç²¾å‡†è¡¡é‡å¤§éªŒè¯è€…çš„å½±å“ï¼‰ã€‚</span><br><span class="line">Average Unweighted Skip Rate	ç›´æ¥å¹³å‡æ‰€æœ‰éªŒè¯è€…çš„ æœªåŠ æƒè·³è¿‡ç‡ï¼Œä¸è€ƒè™‘è´¨æŠ¼æƒé‡ã€‚</span><br><span class="line">Active Stake	å½“å‰æ‰€æœ‰ æ´»è·ƒéªŒè¯è€… çš„ æ€»è´¨æŠ¼é‡ï¼ˆè¿™é‡Œæ˜¯ 999999.99771712 SOLï¼Œä»£è¡¨æ¥è¿‘ 100 ä¸‡ SOL è´¨æŠ¼åœ¨æœ¬åœ°ç½‘ç»œï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">Stake By Version:</span><br><span class="line">2.1.14  -    1 current validators (100.00%)</span><br><span class="line">2.1.14ï¼šè¿è¡Œ Solana 2.1.14 ç‰ˆæœ¬çš„éªŒè¯è€…æ•°é‡åŠå…¶å æ¯”ã€‚</span><br><span class="line">1 current validatorsï¼šè¡¨ç¤ºå½“å‰ç½‘ç»œä¸Šæœ‰ 1 ä¸ªéªŒè¯è€…ã€‚</span><br><span class="line">100.00%ï¼šè¡¨ç¤º æ‰€æœ‰éªŒè¯è€…éƒ½åœ¨è¿è¡Œè¯¥ç‰ˆæœ¬ï¼ˆå› ä¸ºæœ¬åœ°æµ‹è¯•ç½‘ç»œåªæœ‰ä¸€ä¸ªéªŒè¯è€…ï¼‰ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>æœ¬åœ°æµ‹è¯•ç½‘åªæœ‰ä¸€ä¸ªéªŒè¯è€…</strong>ï¼ˆ<code>bX9DbMJsWdvcjmm7irhLwZ9kXs5sTGtpNHZSyMwVRB7</code>ï¼‰ï¼ˆidentifyï¼‰ã€‚</p>
<p>å¾—åˆ°vote account <code>3ZBeiPTQuP7aAQJEzoDVbTLiRabYAbVayo6JvRQZc2yu</code></p>
<p><strong>è´¨æŠ¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">solana delegate-stake [FLAGS] [OPTIONS] &lt;STAKE_ACCOUNT_ADDRESS&gt; &lt;VOTE_ACCOUNT_ADDRESS&gt;</span><br><span class="line"></span><br><span class="line">solana delegate-stake ~/account/c1.json</span><br><span class="line">3ZBeiPTQuP7aAQJEzoDVbTLiRabYAbVayo6JvRQZc2yu</span><br></pre></td></tr></table></figure>

<p>ç„¶åè´¨æŠ¼è´¦æˆ·æ˜¾ç¤ºdelegated</p>
<p><strong>å–æ¶ˆè´¨æŠ¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana deactivate-stake [FLAGS] [OPTIONS] &lt;STAKE_ACCOUNT_ADDRESS&gt;</span><br><span class="line"></span><br><span class="line">solana deactivate-stake ~/account/c1.json</span><br></pre></td></tr></table></figure>



<p><strong>æç°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana withdraw-stake [FLAGS] [OPTIONS] &lt;STAKE_ACCOUNT_ADDRESS&gt; &lt;RECIPIENT_ADDRESS&gt; &lt;AMOUNT&gt;</span><br><span class="line"></span><br><span class="line">solana withdraw-stake ~/account/c1.json DJEniGyLz8DQCXQUshro9TwqGUWGgQ1PpYgMC9dCoNM9 100</span><br></pre></td></tr></table></figure>

<p>å…¨éƒ¨æç°åstake accountå°†é”€æ¯</p>
<h4 id="3-Staking-SOL-with-Solanaâ€™s-JavaScript-API"><a href="#3-Staking-SOL-with-Solanaâ€™s-JavaScript-API" class="headerlink" title="3.Staking SOL with Solanaâ€™s JavaScript API"></a>3.Staking SOL with Solanaâ€™s JavaScript API</h4><p>å¯ä»¥çœ‹ä¸‹æ–‡æ¡£</p>
<p>stake program</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// #1. åˆ›å»ºè´¨æŠ¼è´¦æˆ·</span><br><span class="line">const transaction = StakeProgram.createAccount(&#123;</span><br><span class="line">    fromPubkey: wallet.publicKey,</span><br><span class="line">    stakePubkey: stakeAccount.publicKey,</span><br><span class="line">    authorized: new Authorized(wallet.publicKey, wallet.publicKey),</span><br><span class="line">    lamports: 10 * LAMPORTS_PER_SOL</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// #2. è¿›è¡Œå§”æ‰˜</span><br><span class="line">const validatorVoteAccount = new PublicKey(&quot;YOUR_VALIDATOR_VOTE_ACCOUNT&quot;);</span><br><span class="line"></span><br><span class="line">const transaction = StakeProgram.delegate(&#123;</span><br><span class="line">    stakePubkey: stakeAccount.publicKey,</span><br><span class="line">    authorizedPubkey: wallet.publicKey,</span><br><span class="line">    votePubkey: validatorVoteAccount</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="ï¼ˆ2ï¼‰liquid-staking"><a href="#ï¼ˆ2ï¼‰liquid-staking" class="headerlink" title="ï¼ˆ2ï¼‰liquid staking"></a>ï¼ˆ2ï¼‰liquid staking</h2><p>native stakingåœ¨è´¨æŠ¼åä¸èƒ½ä½¿ç”¨solè¿›è¡Œäº¤æ˜“å’Œæµé€šäº†ï¼Œæ‰€ä»¥è¯ç”Ÿliquid stakingã€‚åœ¨è´¨æŠ¼åä¼šè·å¾—proxy token(liquid stake pool token),è¿™äº›tokenå¯ä»¥ç”¨æ¥swapã€tradedã€transferredã€‚</p>
<p>å…³äºæµåŠ¨æ€§è´¨æŠ¼ï¼Œå®˜æ–¹æä¾›äº†å®˜æ–¹åˆçº¦ <code>Stake Pools</code></p>
<p>Solana Stake Pool Program</p>
<p>æ ‡å‡†è´¨æŠ¼æ± ï¼Œå®ç°äº†validatoråˆ†é…ç­–ç•¥ï¼Œè´¹ç”¨ï¼Œä»æ± ä¸­å§”æ‰˜&#x2F;æå–èµ„é‡‘çš„æŒ‡ä»¤</p>
<p>IDï¼šSPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy</p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://spl.solana.com/stake-pool">Solana Stake Pool Program Documentation</a></p>
<p>è§’è‰²ï¼š</p>
<ul>
<li>Pool Managerï¼šè´¨æŠ¼æ± çš„ç®¡ç†å‘˜åŠç›¸å…³è§’è‰²</li>
<li>User Walletï¼šç”¨æˆ·é€šè¿‡è´¨æŠ¼è´¦æˆ·è´¨æŠ¼æˆ–è€…ç›´æ¥è´¨æŠ¼SOL</li>
<li>Validator Listï¼šéªŒè¯èŠ‚ç‚¹åˆ—è¡¨ï¼Œvalidatoré€šè¿‡vote accountæ¥æ”¶è´¨æŠ¼</li>
</ul>
<p><strong>æ­¥éª¤</strong></p>
<p>user wallet account -&gt;</p>
<p>(owner staking program)stake account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stake authority address</span><br><span class="line">withdraw authority address</span><br><span class="line">lockup authority address</span><br><span class="line">delegated vote address</span><br></pre></td></tr></table></figure>

<p>-&gt;Stake Pool (owner: Stake Pool Program, manager: Manager)</p>
<p>-&gt;vote account</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">validator identity</span><br><span class="line">vote authority</span><br><span class="line">withdraw authority</span><br><span class="line">owner</span><br></pre></td></tr></table></figure>

<h4 id="è´¨æŠ¼æ± ä»‹ç»"><a href="#è´¨æŠ¼æ± ä»‹ç»" class="headerlink" title="è´¨æŠ¼æ± ä»‹ç»"></a>è´¨æŠ¼æ± ä»‹ç»</h4><p><strong>è´¹ç”¨ï¼ˆæ”¶ç›Šï¼‰</strong></p>
<p>SOL Deposit, Stake Deposit, SOL Withdrawal, Stake Withdrawal,</p>
<p>Epoch(stake reward): è´¨æŠ¼æ±  <strong>åœ¨æ¯ä¸ª Epoch ç»“æŸæ—¶</strong> æ”¶å–ä¸€éƒ¨åˆ† <strong>è´¨æŠ¼å¥–åŠ±</strong> ä½œä¸ºè´¹ç”¨,æŒ‰ <strong>æ€»æ”¶ç›Šçš„ç™¾åˆ†æ¯”</strong> æ”¶å–ï¼Œè€Œä¸æ˜¯æŒ‰ç”¨æˆ·å­˜æ¬¾é‡‘é¢æ”¶å–</p>
<p>Referral: å½“ç”¨æˆ· <strong>é€šè¿‡åˆä½œä¼™ä¼´ï¼ˆå¦‚é’±åŒ…æˆ– DAppï¼‰å­˜å…¥ SOL</strong> æ—¶ï¼Œåˆä½œæ–¹å¯èƒ½ä¼šæ”¶åˆ°ä¸€éƒ¨åˆ†æ¨èå¥–åŠ±ã€‚æŒ‰ <strong>å­˜å…¥è´¹ç”¨çš„ç™¾åˆ†æ¯”</strong> è®¡ç®—ã€‚</p>
<p>å…¶ä¸­SOL å’Œ Stakeåˆ†åˆ«æ˜¯ç›´æ¥è´¨æŠ¼ï¼Œå’Œå·²ç»æœ‰è´¨æŠ¼è´¦æˆ·äº†äº¤ç»™è´¨æŠ¼æ± ç®¡ç†ã€‚</p>
<h4 id="åˆ›å»ºè´¨æŠ¼æ± "><a href="#åˆ›å»ºè´¨æŠ¼æ± " class="headerlink" title="åˆ›å»ºè´¨æŠ¼æ± "></a>åˆ›å»ºè´¨æŠ¼æ± </h4><p><strong>1.ä½¿ç”¨å‘½ä»¤è¡Œ</strong>solana CLI</p>
<p>å¯åŠ¨æœ¬åœ°ç¯å¢ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">solana-test-validator \</span><br><span class="line">  --clone-upgradeable-program SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy \</span><br><span class="line">  --clone-upgradeable-program metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s \</span><br><span class="line">  --url mainnet-beta \</span><br><span class="line">  --slots-per-epoch 32 \</span><br><span class="line">  --quiet --reset </span><br><span class="line"></span><br><span class="line">solana config set --url http://127.0.0.1:8899</span><br><span class="line">solana config set --commitment confirmed</span><br></pre></td></tr></table></figure>

<p><strong>å…‹éš†ä¸»ç½‘çš„å¯å‡çº§ç¨‹åº</strong></p>
<ul>
<li><code>--clone-upgradeable-program SPoo1Ku8WFXoNDMHPsrGSTSG1Y47rzgn41SLUNakuHy</code><br>â†’ è¿™æ˜¯ <strong>Stake Pool ç¨‹åº</strong>ï¼Œç”¨äºç®¡ç†æµåŠ¨æ€§è´¨æŠ¼æ± ã€‚</li>
<li><code>--clone-upgradeable-program metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s</code><br>â†’ è¿™æ˜¯ <strong>Metaplex Token Metadata Program</strong>ï¼Œç”¨äº NFT å’Œ SPL ä»£å¸çš„å…ƒæ•°æ®ç®¡ç†ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šè¿™æ ·ä½ çš„æœ¬åœ°æµ‹è¯•ç½‘ç»œï¼ˆtest-validatorï¼‰å¯ä»¥è¿è¡Œè¿™äº›ä¸»ç½‘ä¸Šçš„æ™ºèƒ½åˆçº¦ï¼Œè€Œä¸ç”¨è‡ªå·±éƒ¨ç½²å®ƒä»¬</li>
</ul>
<p><strong>ä½¿ç”¨ <code>--url mainnet-beta</code></strong></p>
<ul>
<li>ä½ çš„ <code>solana-test-validator</code> <strong>ä»ä¸»ç½‘å…‹éš†è¿™äº›ç¨‹åºå’ŒçŠ¶æ€</strong>ï¼Œä½¿æœ¬åœ°ç¯å¢ƒä¸ä¸»ç½‘æ•°æ®æ›´æ¥è¿‘ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šä½ çš„æœ¬åœ°ç¯å¢ƒä¼šæœ‰ä¸»ç½‘ç±»ä¼¼çš„æ•°æ®ï¼Œé€‚ç”¨äºæ¨¡æ‹Ÿæµ‹è¯•ï¼Œä¾‹å¦‚ <strong>éªŒè¯æµåŠ¨æ€§è´¨æŠ¼æ± é€»è¾‘</strong>ã€<strong>NFT ç›¸å…³äº¤äº’</strong>ã€‚</li>
</ul>
<p><strong>è‡ªå®šä¹‰ Epoch é•¿åº¦ (<code>--slots-per-epoch 32</code>)</strong></p>
<ul>
<li>Solana ä¸»ç½‘æ¯ä¸ª Epoch çº¦ <strong>432,000 slotsï¼ˆ2-3 å¤©ï¼‰</strong>ï¼Œè€Œä½ æœ¬åœ°æµ‹è¯•è®¾ç½®çš„ Epoch åªæœ‰ <code>32</code> ä¸ª slotã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šåœ¨æœ¬åœ°æµ‹è¯•ç¯å¢ƒä¸­ï¼Œä½ çš„ <strong>Epoch è½®æ¢é€Ÿåº¦æ›´å¿«</strong>ï¼Œä¾¿äºæµ‹è¯• <strong>è´¨æŠ¼å¥–åŠ±è®¡ç®—ã€æç°ç­‰å¾…æ—¶é—´</strong> ç­‰ã€‚</li>
</ul>
<p><strong><code>--quiet --reset</code></strong></p>
<ul>
<li><code>--quiet</code>ï¼šå‡å°‘æ—¥å¿—è¾“å‡ºï¼Œä¿æŒç»ˆç«¯æ•´æ´ã€‚</li>
<li><code>--reset</code>ï¼šæ¸…é™¤ä¹‹å‰çš„æµ‹è¯•é“¾çŠ¶æ€ï¼Œé‡æ–°å¯åŠ¨ä¸€ä¸ªå¹²å‡€çš„æœ¬åœ°é“¾ã€‚</li>
</ul>
<p><strong>Commitment çº§åˆ«å¯¹æ¯”ï¼š</strong></p>
<table>
<thead>
<tr>
<th>çº§åˆ«</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>processed</strong></td>
<td>äº¤æ˜“å·²è¢« Leader å¤„ç†ï¼Œä½†å¯èƒ½æœªä¸Šé“¾ï¼ˆæœ€å¿«ï¼Œæœ€ä¸å®‰å…¨ï¼‰ã€‚</td>
</tr>
<tr>
<td><strong>confirmed</strong></td>
<td>äº¤æ˜“å·²ç¡®è®¤è‡³å°‘ 1 ä¸ªåŒºå—ï¼Œä½†å¯èƒ½ä¼šè¢«å›æ»šï¼ˆè¾ƒå¿«ï¼Œè¾ƒå®‰å…¨ï¼‰ã€‚</td>
</tr>
<tr>
<td><strong>finalized</strong></td>
<td>äº¤æ˜“å·²è¢«å¤§å¤šæ•°éªŒè¯è€…ç¡®è®¤ï¼ŒåŸºæœ¬ä¸å¯å›æ»šï¼ˆæœ€æ…¢ï¼Œæœ€å®‰å…¨ï¼‰ã€‚</td>
</tr>
</tbody></table>
<p><strong>2.åˆ›å»ºè´¨æŠ¼æ± </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool create-pool \</span><br><span class="line">	  --epoch-fee-denominator 100 \</span><br><span class="line">    --epoch-fee-numerator 2 \</span><br><span class="line">    --max-validators 10 \</span><br><span class="line">    --withdrawal-fee-denominator 1000 \</span><br><span class="line">    --withdrawal-fee-numerator 1 \</span><br><span class="line">    --deposit-fee-numerator 3 \</span><br><span class="line">    --deposit-fee-denominator 1000 \</span><br><span class="line">    --referral-fee 0</span><br></pre></td></tr></table></figure>

<ul>
<li><code>--epoch-fee-denominator</code>: åˆ†æ¯ï¼Œè´¹ç”¨çš„åº•æ•°ã€‚å¦‚æœè®¾ç½®æˆ100ï¼Œæ‰€æœ‰è´¹ç”¨éƒ½æ˜¯ç™¾åˆ†æ•°</li>
<li><code>--epoch-fee-numerator</code>: åˆ†å­ï¼Œç®¡ç†çš„æ‰‹ç»­è´¹ã€‚å¦‚æœvalidatoræ”¶8%ï¼Œstake poolæ”¶2%ï¼Œå¯¹äº100SOLçš„å¥–åŠ±ï¼Œç”¨æˆ·åˆ°æ‰‹90.16 SOL</li>
<li><code>--max-validators</code>é™åˆ¶ stake pool èƒ½å¤Ÿå§”æ‰˜çš„æœ€å¤§ validator æ•°é‡ã€‚</li>
</ul>
<p><strong>å…¶ä»–å‚æ•°</strong></p>
<ul>
<li><code>--withdrawal-fee-[denominator|numerator]</code>: æç°çš„æ‰‹ç»­è´¹</li>
<li><code>--deposit-fee-[denominator|numerator]</code>: è´¨æŠ¼çš„æ‰‹ç»­è´¹</li>
<li><code>--referral-fee</code>ï¼šä»‹ç»è´¹</li>
<li><code>--manager &lt;KEYPAIR&gt;</code>: stake poolçš„ç®¡ç†å‘˜[default: cli config keypair]</li>
</ul>
<p><strong>æ‰€æœ‰çš„è´¦æˆ·åœ°å€æˆ‘ä»¬éƒ½å¯ä»¥æŒ‡å®šï¼Œä¸æŒ‡å®šçš„è¯ä¼šåˆ›å»ºæ–°çš„åœ°å€</strong></p>
<ul>
<li><code>--pool-keypair &lt;PATH&gt;</code>: stake pool</li>
<li><code>--validator-list-keypair &lt;PATH&gt;</code>: validator list<strong>å­˜å‚¨ validator åˆ—è¡¨çš„ keypair</strong>ã€‚</li>
<li><code>--mint-keypair &lt;PATH&gt;</code>: mintè´¦æˆ·ä½¿ç”¨çš„keypair [default: new keypair]</li>
<li><code>--reserve-keypair &lt;PATH&gt;</code>: pool reserve stake account</li>
</ul>
<p><strong>å®è·µ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool create-pool [FLAGS] [OPTIONS] --epoch-fee-denominator &lt;DENOMINATOR&gt; --epoch-fee-numerator &lt;NUMERATOR&gt; --max-validators &lt;NUMBER&gt;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool create-pool \</span><br><span class="line">	  --epoch-fee-denominator 100 \</span><br><span class="line">    --epoch-fee-numerator 2 \</span><br><span class="line">    --max-validators 10 \</span><br><span class="line">    --withdrawal-fee-denominator 1000 \</span><br><span class="line">    --withdrawal-fee-numerator 1 \</span><br><span class="line">    --deposit-fee-numerator 3 \</span><br><span class="line">    --deposit-fee-denominator 1000 \</span><br><span class="line">    --referral-fee 0</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Creating reserve stake B7tx4tHc1xtzjJCJww7ACwmMeFFqrAz5QSfLG5XXccRw</span><br><span class="line">Creating mint 2THtxSUcyofvJVFATsE3sh8BAT6PDRMtGaHb9aHTsgwr</span><br><span class="line">Creating associated token account 6owg51hRW2XDv9aKgS7VYuRTSMUM6cxt8BqseVUite4k to receive stake pool tokens of mint 2THtxSUcyofvJVFATsE3sh8BAT6PDRMtGaHb9aHTsgwr, owned by DJEniGyLz8DQCXQUshro9TwqGUWGgQ1PpYgMC9dCoNM9</span><br><span class="line">Creating pool fee collection account 6owg51hRW2XDv9aKgS7VYuRTSMUM6cxt8BqseVUite4k</span><br><span class="line">Setting up required accounts for stake pool: reserve stake B7tx4tHc1xtzjJCJww7ACwmMeFFqrAz5QSfLG5XXccRw and mint 2THtxSUcyofvJVFATsE3sh8BAT6PDRMtGaHb9aHTsgwr</span><br><span class="line">Signature: 3eXkFgzRgjoBHAej2KxDHpN9crMXkALUpL4puuPPaLkzihbzSUjHYNULXaKqMJL9Y2bGXKqJgdACNhpAqgTmDBzJ</span><br><span class="line">Creating stake pool FEuogfwYkFHJz9pXJXxP6RhTNq4m25U1wxxXWVyT6hCX with validator list HxoXoqx82j6C4LzPmZvjF2bfRB1zSXPC6RQK4bC11TVp</span><br><span class="line">Signature: 2dNuaT2dA3bfRK5xdY6cHg9gCDdq2JTLT81D9xiQywddyLHUs4KN4NmBBxt6aaqgwvcJ3zx5cVLSTSdNefkDWxcr</span><br></pre></td></tr></table></figure>

<p><strong>Reserve Stake Account</strong>ï¼šè¿™æ˜¯ <code>Stake Pool</code> çš„<strong>å‚¨å¤‡è´¦æˆ·</strong>ï¼Œç”¨äºå­˜æ”¾å°šæœªåˆ†é…ç»™ <code>validator</code> çš„è´¨æŠ¼ <code>SOL</code>ã€‚å½“ç”¨æˆ·å°† <code>SOL</code> è´¨æŠ¼è¿› <code>Stake Pool</code> æ—¶ï¼Œ<code>SOL</code> ä¼šå…ˆè¿›å…¥ <code>Reserve Stake Account</code>ï¼Œç„¶åç”± <code>stake pool</code> è¿›è¡Œç®¡ç†å’Œåˆ†é…ã€‚</p>
<p><strong>Associated Token Accountï¼ˆATAï¼Œç”¨æˆ·SPLä»£å¸è´¦æˆ·ï¼‰ï¼š</strong>è¿™ä¸ªè´¦æˆ·æ˜¯ç”¨æˆ· <code>DJEniGyLz8DQCXQUshro9TwqGUWGgQ1PpYgMC9dCoNM9</code> å…³è”çš„ SPL ä»£å¸è´¦æˆ·ï¼ˆATAï¼‰ï¼Œç”¨äºæ¥æ”¶ <code>Stake Pool</code> ä»£å¸ã€‚<code>Stake Pool</code> è¿è¡Œæ—¶ï¼Œç”¨æˆ·å­˜å…¥ <code>SOL</code> åï¼Œç­‰å€¼çš„ <code>Stake Pool</code> ä»£å¸ï¼ˆå¦‚ <code>stSOL</code>ï¼‰ä¼šå­˜å…¥è¿™ä¸ª <code>ATA</code>ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨è¯¥è´¦æˆ·ç®¡ç†è‡ªå·±çš„ <code>stSOL</code> èµ„äº§</p>
<p><strong>Pool Fee Collection Accountï¼ˆæ‰‹ç»­è´¹æ”¶é›†è´¦æˆ·ï¼‰</strong>ï¼š<code>Stake Pool</code> æ”¶å–çš„ç®¡ç†è´¹ç”¨ï¼ˆå¦‚ <code>epoch fee</code>ã€<code>withdrawal fee</code>ï¼‰ä¼šå­˜å…¥è¿™ä¸ªè´¦æˆ·ã€‚ä¸€èˆ¬ç”± <code>Stake Pool</code> ç®¡ç†å‘˜ï¼ˆ<code>manager</code>ï¼‰æ§åˆ¶ï¼Œå¯ä»¥å®šæœŸæå–ç”¨äºè¿è¥ <code>Stake Pool</code>ã€‚</p>
<p><strong>Validator List Accountï¼ˆéªŒè¯è€…åˆ—è¡¨è´¦æˆ·ï¼‰ï¼š</strong><code>Stake Pool</code> è´¨æŠ¼ <code>SOL</code> æ—¶ï¼Œä¼šåˆ†é…ç»™å¤šä¸ª <code>Validator</code>ï¼Œè¿™ä¸ªè´¦æˆ·è®°å½•æ‰€æœ‰ <code>Stake Pool</code> ä½¿ç”¨çš„ <code>Validator</code> åˆ—è¡¨ã€‚å…¶ä¸­åŒ…å«æ¯ä¸ª <code>Validator</code> çš„ <code>stake account</code>ã€è´¨æŠ¼çš„ <code>SOL</code> æ•°é‡ç­‰ä¿¡æ¯ã€‚</p>
<p><strong>Stake Pool Accountï¼ˆè´¨æŠ¼æ± è´¦æˆ·ï¼‰</strong>ï¼šStake Pool<code>çš„**ä¸»è´¦æˆ·**ï¼Œç”¨äºç®¡ç†æ•´ä¸ª</code>Stake Poolï¼Œè¿™ä¸ªè´¦æˆ·ä¼šå…³è” <code>Reserve Stake Account</code>ã€<code>Mint Account</code>ã€<code>Validator List Account</code> ç­‰æ ¸å¿ƒè´¦æˆ·ã€‚å½“ç”¨æˆ·å­˜å…¥ <code>SOL</code> æ—¶ï¼Œè¿™ä¸ªè´¦æˆ·ä¼šè®°å½• <code>Stake Pool</code> ä»£å¸çš„é“¸é€ æƒ…å†µï¼Œå¹¶å¤„ç† <code>Stake Pool</code> çš„æ•´ä½“è¿ä½œã€‚</p>
<h4 id="æŸ¥çœ‹è´¨æŠ¼æ± çŠ¶æ€"><a href="#æŸ¥çœ‹è´¨æŠ¼æ± çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹è´¨æŠ¼æ± çŠ¶æ€"></a><strong>æŸ¥çœ‹è´¨æŠ¼æ± çŠ¶æ€</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool list -v &lt;stake pool address&gt;</span><br><span class="line"></span><br><span class="line">spl-stake-pool list -v FEuogfwYkFHJz9pXJXxP6RhTNq4m25U1wxxXWVyT6hCX</span><br></pre></td></tr></table></figure>





<h4 id="è§£é‡Šè´¨æŠ¼æ± ç›¸å…³è´¦æˆ·"><a href="#è§£é‡Šè´¨æŠ¼æ± ç›¸å…³è´¦æˆ·" class="headerlink" title="è§£é‡Šè´¨æŠ¼æ± ç›¸å…³è´¦æˆ·"></a>è§£é‡Šè´¨æŠ¼æ± ç›¸å…³è´¦æˆ·</h4><p><strong>Stake pool account:</strong><br>poolMint, validatorList, manager, staker, reserveStake</p>
<p>è¿åˆ°3ä¸ªè´¦æˆ·</p>
<p>1.<strong>Mint Account</strong>:</p>
<p>decimals, mint_authority</p>
<p>å…¶ä¸­</p>
<p>1.1<strong>user wallet account</strong>(owner system program) - &gt;</p>
<p><strong>stake account:</strong></p>
<p>stake authority address, withdraw authority address, lockup authority address</p>
<p><strong>token account</strong>:</p>
<p>mint, authority&#x2F;owner</p>
<p>1.2<strong>manager wallet account</strong>(owner system program):</p>
<p><strong>pool fee token account</strong>: mint, authority&#x2F;owner</p>
<p><strong>2.reserve stake account:(owner stake program)</strong>:</p>
<p>stake authority, withdraw authority -&gt;</p>
<p><strong>Manager wallet account</strong></p>
<p><strong>3.validator accounts:</strong><br>validators   </p>
<p>-&gt; <strong>Vote account</strong>:</p>
<p>validator identify(account 1), vote authority(account 1), withdraw authority(account 2), owner(vote program)</p>
<p>-&gt; stake account: delegated vote address</p>
<p>transient stake address: delegated vote address</p>
<p>æ˜¯ä¸€ä¸ªä¸´æ—¶è´¦æˆ·ï¼Œä¸»è¦ç”¨äºçŸ­æœŸçš„è´¨æŠ¼æ“ä½œã€‚å®ƒé€šå¸¸ä¸ä¼šæŒä¹…å­˜åœ¨ï¼Œè€Œæ˜¯åœ¨æŸäº›æ“ä½œåä¼šè¢«é”€æ¯æˆ–æ›¿æ¢ã€‚è¿™ç±»åœ°å€ç”¨äºä¸´æ—¶å­˜å‚¨è´¨æŠ¼çš„ <code>SOL</code>ï¼Œé€šå¸¸åœ¨ä¸ <code>Validator</code> æˆ– <code>Stake Pool</code> è¿›è¡Œè´¨æŠ¼æ—¶ä½¿ç”¨ã€‚</p>
<p>ç›´æ¥è´¨æŠ¼solå°±ä¼šå…ˆè¿› reserve stake account,reverse accountå†åˆ†é…ç»™å¯¹åº”çš„vote account</p>
<h4 id="ä¿®æ”¹è´¨æŠ¼æ± "><a href="#ä¿®æ”¹è´¨æŠ¼æ± " class="headerlink" title="ä¿®æ”¹è´¨æŠ¼æ± "></a>ä¿®æ”¹è´¨æŠ¼æ± </h4><p><strong>ä¿®æ”¹manager</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool set-manager [FLAGS] [OPTIONS] &lt;POOL_ADDRESS&gt; &lt;--new-manager &lt;KEYPAIR&gt;|--new-fee-receiver &lt;ADDRESS&gt;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹è´¹ç”¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool set-fee [FLAGS] [OPTIONS] &lt;POOL_ADDRESS&gt; &lt;FEE_TYPE&gt; &lt;NUMERATOR&gt; &lt;DENOMINATOR&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹staker</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool set-staker [FLAGS] [OPTIONS] &lt;POOL_ADDRESS&gt; [ADDRESS]</span><br></pre></td></tr></table></figure>

<h4 id="æ·»åŠ validator"><a href="#æ·»åŠ validator" class="headerlink" title="æ·»åŠ validator"></a>æ·»åŠ validator</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">solana validators -u localhost</span><br><span class="line">æŸ¥çœ‹æœ¬åœ°çš„éªŒè¯å™¨å’Œvoteè´¦æˆ·</span><br><span class="line"></span><br><span class="line">å…ˆè´¨æŠ¼ç»™reverse accountä¸€äº›</span><br><span class="line"></span><br><span class="line">spl-stake-pool deposit-sol &lt;è´¨æŠ¼æ± åœ°å€&gt; æ•°é‡</span><br><span class="line"></span><br><span class="line">spl-stake-pool add-validator &lt;YOUR_STAKE_POOL_ADDRESS&gt; &lt;VOTE_ACCOUNT_ADDRESS&gt;</span><br><span class="line"></span><br><span class="line">spl-stake-pool list -v &lt;YOUR_STAKE_POOL_ADDRESS&gt;</span><br></pre></td></tr></table></figure>

<p>æŠŠvote è´¦æˆ·æ·»åŠ è¿› validator list</p>
<h3 id="å¯¹äºç”¨æˆ·çš„è´¨æŠ¼"><a href="#å¯¹äºç”¨æˆ·çš„è´¨æŠ¼" class="headerlink" title="å¯¹äºç”¨æˆ·çš„è´¨æŠ¼"></a>å¯¹äºç”¨æˆ·çš„è´¨æŠ¼</h3><p>1.webç•Œé¢</p>
<p>2.ä½¿ç”¨è´¨æŠ¼è´¦æˆ·è¿›è¡ŒæµåŠ¨æ€§è´¨æŠ¼</p>
<p><strong>åˆ‡æ¢ä¸‹èº«ä»½</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana config set -k ./user.json</span><br><span class="line">solana address -k user.json</span><br><span class="line">solana airdrop 100 &lt;ADDRESS&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨æ–°èº«ä»½è¿›è¡Œè´¨æŠ¼è´¨æŠ¼stake account</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">solana create-stake-account stake-account.json 100 </span><br><span class="line"></span><br><span class="line">solana delegate-stake stake-account.json &lt;VOTE_ACCOUNT&gt;  </span><br><span class="line"></span><br><span class="line">//æŠŠè´¨æŠ¼è´¦æˆ·å†è´¨æŠ¼ç»™è´¨æŠ¼æ± </span><br><span class="line">spl-stake-pool deposit-stake &lt;POOL_ADDRESS&gt; &lt;STAKE_ACCOUNT_ADDRESS&gt; [ADDRESS]</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solana delegate-stake ~/account/c2stake.json BMfiMP5LEmtJoGWpLajdUpBNaCtDwBeG1RHXVWcJBUkp</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨è´¨æŠ¼è´¦æˆ·æç°"><a href="#ä½¿ç”¨è´¨æŠ¼è´¦æˆ·æç°" class="headerlink" title="ä½¿ç”¨è´¨æŠ¼è´¦æˆ·æç°"></a>ä½¿ç”¨è´¨æŠ¼è´¦æˆ·æç°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool withdraw-stake &lt;YOUR_STAKE_POOL_ADDRESS&gt; ï¼ˆè¿™é‡Œå¯ä»¥æŒ‡å®šè´¨æŠ¼è´¦æˆ·ï¼Œä¸æŒ‡å®šå°±ä¼šæ–°å»ºä¸€ä¸ªæ–°çš„ï¼‰ &lt;AMOUNT&gt;</span><br></pre></td></tr></table></figure>

<h4 id="ç›´æ¥å¾€è´¨æŠ¼ä¸­è´¨æŠ¼sol"><a href="#ç›´æ¥å¾€è´¨æŠ¼ä¸­è´¨æŠ¼sol" class="headerlink" title="ç›´æ¥å¾€è´¨æŠ¼ä¸­è´¨æŠ¼sol"></a>ç›´æ¥å¾€è´¨æŠ¼ä¸­è´¨æŠ¼sol</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool deposit-sol</span><br><span class="line">spl-stake-pool deposit-sol [FLAGS] [OPTIONS] &lt;POOL_ADDRESS&gt; [AMOUNT]</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†é…reverse"><a href="#åˆ†é…reverse" class="headerlink" title="åˆ†é…reverse"></a>åˆ†é…reverse</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">solana config set -k ~/.config/solana/id.json</span><br><span class="line"></span><br><span class="line">spl-stake-pool (decrease)increase-validator-stake &lt;YOUR_STAKE_POOL_ADDRESS&gt; &lt;VOTE_ACCOUNT_ADDRESS&gt; [AMOUNT]</span><br><span class="line">è¿›å…¥äº†transient account(å› ä¸ºè¿˜æ²¡è¿›å…¥ä¸‹ä¸€å‘¨æœŸï¼Œæ›´æ–°)</span><br><span class="line"></span><br><span class="line">spl-stake-pool list -v &lt;YOUR_STAKE_POOL_ADDRESS&gt;</span><br></pre></td></tr></table></figure>

<p>æ›´æ–°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">solana epoch-info</span><br><span class="line">spl-stake-pool update &lt;YOUR_STAKE_POOL_ADDRESS&gt;</span><br></pre></td></tr></table></figure>

<h4 id="æç°"><a href="#æç°" class="headerlink" title="æç°"></a>æç°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool withdraw-sol &lt;YOUR_STAKE_POOL_ADDRESS&gt; ./user.json &lt;AMOUNT&gt;</span><br><span class="line"></span><br><span class="line">spl-stake-pool withdraw-sol [FLAGS] [OPTIONS] &lt;POOL_ADDRESS&gt; &lt;SYSTEM_ACCOUNT_ADDRESS_OR_KEYPAIR&gt; &lt;AMOUNT&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-stake-pool withdraw-sol </span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æç°æç°çš„æ˜¯reverse accountä¸­çš„ä½™é¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">solana config set -k ~/.config/solana/id.json</span><br><span class="line">spl-stake-pool decrease-validator-stake &lt;YOUR_STAKE_POOL_ADDRESS&gt; &lt;VOTE_ACCOUNT_ADDRESS&gt; [AMOUNT]</span><br></pre></td></tr></table></figure>



<h2 id="Application-Level-Staking"><a href="#Application-Level-Staking" class="headerlink" title="Application-Level Staking"></a>Application-Level Staking</h2><h3 id="é€»è¾‘"><a href="#é€»è¾‘" class="headerlink" title="é€»è¾‘"></a>é€»è¾‘</h3><p>1.User wallet account -&gt; token account: mint, authority&#x2F;owner  &lt;- Token mint account: decimals, mint_authority -&gt; stake program: stake_info -&gt;stake info account: NFT Mint account, staker</p>
<p>â€‹	</p>
<p>2.User wallet account -&gt; token account: mint, authority&#x2F;owner  &lt;- NFT Mint account: decimals, mint_authority -&gt;stake info account: NFT Mint account, staker</p>
<p><strong>Stake info account</strong>ï¼ˆè´¨æŠ¼ä¿¡æ¯è´¦æˆ·ï¼‰<br>â†³ è®°å½• <strong>NFT Mint account</strong>ï¼ˆè¢«è´¨æŠ¼çš„ NFTï¼‰ å’Œ <strong>staker</strong>ï¼ˆå³ NFT çš„è´¨æŠ¼è€…ï¼‰ã€‚</p>
<h2 id="å®é™…æ“ä½œ"><a href="#å®é™…æ“ä½œ" class="headerlink" title="å®é™…æ“ä½œ"></a>å®é™…æ“ä½œ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana program dump --url mainnet-beta metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br><span class="line"></span><br><span class="line">solana-test-validator -r --bpf-program metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br></pre></td></tr></table></figure>



<h1 id="è´¨æŠ¼-1"><a href="#è´¨æŠ¼-1" class="headerlink" title="è´¨æŠ¼"></a>è´¨æŠ¼</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#[derive(Accounts)]</span><br><span class="line">pub struct NftStake&lt;&#x27;info&gt;&#123;</span><br><span class="line">    //æ¥æ”¶nftçš„è´¦æˆ·ï¼Œæ˜¯è°è´¨æŠ¼äº†å“ªä¸ªNFTï¼Ÿ</span><br><span class="line">    #[account(</span><br><span class="line">        init_if_needed,</span><br><span class="line">        payer = authority,</span><br><span class="line">        space = 8 + IbuildStake::INIT_SPACE,</span><br><span class="line">        seeds = [</span><br><span class="line">            IbuildStake::SEED_PREFIX.as_bytes(),</span><br><span class="line">            nft_mint_account.key().as_ref(),</span><br><span class="line">        ],</span><br><span class="line">        bump,</span><br><span class="line">    )]</span><br><span class="line">    pub stake_info:Box&lt;Account&lt;&#x27;info, IbuildStake&gt;&gt;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">use anchor_lang::prelude::*;</span><br><span class="line"></span><br><span class="line">#[account]</span><br><span class="line">#[derive(InitSpace)]</span><br><span class="line">pub struct IbuildStake&#123;</span><br><span class="line">    pub staker: Pubkey,</span><br><span class="line">    pub nft_mint_account:Pubkey,</span><br><span class="line">    pub staked_clock:u64,</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">impl IbuildStake &#123;</span><br><span class="line">    pub const SEED_PREFIX: &amp;&#x27;static str = &quot;stake_v1&quot;; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¿&#x2F;æ¯ä¸€ä¸ªNFTçš„è´¨æŠ¼éƒ½ä¼šæœ‰ä¸€ä¸ªstake infoï¼Œå­˜å‚¨è´¨æŠ¼çš„ä¿¡æ¯å¾ˆå°‘ï¼Œåªéœ€è¦å­˜å‚¨3ä¸ªå­—æ®µï¼Œæ¯ä¸€ä¸ªè´¨æŠ¼çš„NFTéƒ½ä¼šæœ‰ä¸€ä¸ªå…³è”çš„è´¨æŠ¼çš„çŠ¶æ€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#[account(</span><br><span class="line">    init_if_needed,</span><br><span class="line">    payer = authority,</span><br><span class="line">    space = 8 + IbuildStake::INIT_SPACE,</span><br><span class="line">    seeds = [</span><br><span class="line">        IbuildStake::SEED_PREFIX.as_bytes(),</span><br><span class="line">        nft_mint_account.key().as_ref(),</span><br><span class="line">    ],</span><br><span class="line">    bump,</span><br><span class="line">)]</span><br><span class="line">pub stake_info:Box&lt;Account&lt;&#x27;info, IbuildStake&gt;&gt;,</span><br><span class="line"></span><br><span class="line">#[account(</span><br><span class="line">    init_if_needed,</span><br><span class="line">    payer = authority,</span><br><span class="line">    associated_token::mint = nft_mint_account,</span><br><span class="line">    associated_token::authority = stake_info,</span><br><span class="line">)]</span><br><span class="line"></span><br><span class="line">pub program_receipt_nft_ata:Box&lt;Account&lt;&#x27;info,TokenAccount&gt;&gt;,</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯¹äºNFTæ¥è¯´ï¼Œä¸ä»…ä¼šå…³è”ä¸€ä¸ªstake_infoï¼Œè¯¥stake_infoè¿˜ä¼šæ‹¥æœ‰NFT</p>
<h1 id="ç¼–å†™ä¸€ä¸ªå…¨æ ˆé¡¹ç›®"><a href="#ç¼–å†™ä¸€ä¸ªå…¨æ ˆé¡¹ç›®" class="headerlink" title="ç¼–å†™ä¸€ä¸ªå…¨æ ˆé¡¹ç›®"></a>ç¼–å†™ä¸€ä¸ªå…¨æ ˆé¡¹ç›®</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">solana program dump --url mainnet-beta metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br><span class="line"></span><br><span class="line">solana-test-validator -r --bpf-program metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br></pre></td></tr></table></figure>



<p>åœ¨åˆçº¦é‡Œå¦‚ä½•ç¼–å†™æˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶ï¼Œä»¥åŠå¦‚ä½•æ¥å…¥æˆ‘ä»¬çš„åˆçº¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-solana-dapp@latest</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºä¸€ä¸ªå…¨æ ˆçš„é¡¹ç›®</p>
<p>anchorä¸‹æ”¾çš„æ˜¯åˆçº¦ä»£ç ï¼Œç›¸å½“äºanchor init åˆ›å»ºçš„é¡¹ç›®</p>
<p>anchorä¸‹src:å‰ç«¯æ¥å…¥ä¸€äº›æ¨¡å—ï¼Œä¸‹testå‰ç«¯çš„ä¸€äº›æµ‹è¯•æ–‡ä»¶ï¼Œå…³äºåˆçº¦æµ‹è¯•è„šæœ¬ã€‚</p>
<p>srcç›®å½•å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªnextçš„é¡¹ç›®å¯¹åº”çš„ç›®å½•ï¼Œapiå¯¹åº”åç«¯è·¯ç”±ï¼Œaccountå¯¹åº”è·¯ç”±ï¼Œclusterså’Œcounterå¯¹åº”å‰ç«¯è·¯ç”±</p>
<p>æµ‹è¯•çš„è¯éœ€è¦cdåˆ°anchorç›®å½•ä¸‹,ç„¶å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anchor run test æˆ–è€… </span><br><span class="line">anchor test å› ä¸ºè¿™ä¸ªç®€åŒ–äº†çš„</span><br><span class="line"></span><br><span class="line">npm run anchor-test</span><br></pre></td></tr></table></figure>

<p>anchor testçš„æ—¶å€™ä¼šå¯åŠ¨ä¸€ä¸ªvalidator</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor test --skip-local-validator</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œanchor testæ–‡ä»¶å¯ä»¥çœ‹åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tests/a.spec.ts</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”æˆ‘ä»¬çš„è¿™ä¸ªè„šæœ¬</p>
<h3 id="é‡åˆ°testé—®é¢˜æƒ…å†µ"><a href="#é‡åˆ°testé—®é¢˜æƒ…å†µ" class="headerlink" title="é‡åˆ°testé—®é¢˜æƒ…å†µ"></a>é‡åˆ°testé—®é¢˜æƒ…å†µ</h3><p>1.å…ˆå¯åŠ¨validatorå¯ä»¥åŠ  -rï¼Œå°±å¯ä»¥é€šè¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor test --skip-local-validator</span><br></pre></td></tr></table></figure>



<p>æ‰“å°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(&#x27;RPC URL:&#x27;,provider.connection.rpcEndpoint);</span><br><span class="line"> console.log(&#x27;Wallet Pubkey:&#x27;, provider.wallet.publicKey.toBase58());</span><br></pre></td></tr></table></figure>

<p>è·‘å‰ç«¯é¡¹ç›®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªé’±åŒ…æ¥å…¥ä¸»è¦æœ‰2éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªconnection,è¿™ä¸€éƒ¨åˆ†ä¸»è¦åŒ…æ‹¬anchor point,ç¬¬äºŒéƒ¨åˆ†å°±æ˜¯ä¸€ä¸ªwallet</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src/components/solana/solana-provider.tsxè¿æ¥é’±åŒ…æˆæƒçš„ç›¸å…³æ“ä½œ</span><br></pre></td></tr></table></figure>

<p>æ€ä¹ˆæ ·æ¥å…¥åˆ›å»ºçš„æ¯”å¦‚â€œAâ€è¿™ä¸€ä¸ªåˆçº¦</p>
<p>å¦‚ä½•è°ƒç”¨Initializeçš„åˆçº¦æŒ‡ä»¤ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨src/components/a/a-ui.tsx</span><br><span class="line">é¦–å…ˆè¦åˆå§‹åŒ–program</span><br><span class="line">const &#123; initialize &#125; = useAProgram()</span><br><span class="line">å…¶ç‚¹å¼€åœ¨</span><br><span class="line">src/components/a/a-data-access.tsx</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">export function useAProgram() &#123;</span><br><span class="line">åŒ…é‡Œé¢æä¾›äº†</span><br><span class="line">  const &#123; connection &#125; = useConnection()</span><br><span class="line">  const &#123; cluster &#125; = useCluster()</span><br><span class="line">  const transactionToast = useTransactionToast()</span><br><span class="line">  const provider = useAnchorProvider()</span><br><span class="line">  const programId = useMemo(() =&gt; getAProgramId(cluster.network as Cluster), [cluster])</span><br><span class="line">  const program = useMemo(() =&gt; getAProgram(provider, programId), [provider, programId])</span><br><span class="line"></span><br><span class="line">  const accounts = useQuery(&#123;</span><br><span class="line">    queryKey: [&#x27;a&#x27;, &#x27;all&#x27;, &#123; cluster &#125;],</span><br><span class="line">    queryFn: () =&gt; program.account.a.all(),</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  const getProgramAccount = useQuery(&#123;</span><br><span class="line">    queryKey: [&#x27;get-program-account&#x27;, &#123; cluster &#125;],</span><br><span class="line">    queryFn: () =&gt; connection.getParsedAccountInfo(programId),</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  const initialize = useMutation(&#123;</span><br><span class="line">    mutationKey: [&#x27;a&#x27;, &#x27;initialize&#x27;, &#123; cluster &#125;],</span><br><span class="line">    </span><br><span class="line">    //æ­¤å¤„è¦æ‹¿åˆ°programï¼Œåˆå§‹åŒ–program</span><br><span class="line">    mutationFn: (keypair: Keypair) =&gt;</span><br><span class="line">      program.methods.initialize().accounts(&#123; a: keypair.publicKey &#125;).signers([keypair]).rpc(),</span><br><span class="line">    onSuccess: (signature) =&gt; &#123;</span><br><span class="line">      transactionToast(signature)</span><br><span class="line">      return accounts.refetch()</span><br><span class="line">    &#125;,</span><br><span class="line">    onError: () =&gt; toast.error(&#x27;Failed to initialize account&#x27;),</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨å•å…ƒæµ‹è¯•ä¸Šå·®å¼‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> const program = anchor.workspace.A as Program&lt;A&gt;</span><br><span class="line">å¾ˆç®€å•</span><br></pre></td></tr></table></figure>

<p>åœ¨å‰ç«¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å…ˆæ‰‹åŠ¨æ˜¾ç¤ºå®ä¾‹åŒ–program</span><br><span class="line">  const program = useMemo(() =&gt; getAProgram(provider, programId), [provider, programId])</span><br><span class="line">  </span><br><span class="line">provieråˆè¦</span><br><span class="line">  const provider = useAnchorProvider()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç‚¹å¼€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">export function useAnchorProvider() &#123;</span><br><span class="line">  const &#123; connection &#125; = useConnection()</span><br><span class="line">  const wallet = useWallet()</span><br><span class="line"></span><br><span class="line">  return new AnchorProvider(connection, wallet as AnchorWallet, &#123; commitment: &#x27;confirmed&#x27; &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å’Œtestçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const provider = anchor.AnchorProvider.env()</span><br></pre></td></tr></table></figure>

<p>ä¸€è‡´ï¼Œéƒ½æ˜¯è°ƒç”¨new AnchorProviderçš„æ„é€ å‡½æ•°</p>
<p>provideråé€šè¿‡new Program</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export function getAProgram(provider: AnchorProvider, address?: PublicKey) &#123;</span><br><span class="line">  return new Program(&#123; ...AIDL, address: address ? address.toBase58() : AIDL.address &#125; as A, provider)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†ä¼ å…¥å¯¹åº”çš„idlæ–‡ä»¶ï¼Œaddressåœ¨æ–°ç‰ˆæœ¬åº”è¯¥æ˜¯ä¸éœ€è¦ä¼ çš„ï¼Œå› ä¸ºåœ¨idlä¸­å·²ç»æ‹¿åˆ°äº†addressï¼Œä¸éœ€è¦æ‰‹åŠ¨æ˜¾ç¤ºä¼ å…¥äº†</p>
<p>å®ä¾‹åŒ–programsä¹‹åå°±å¯ä»¥é€šè¿‡program.methods.initialize().accountsè°ƒç”¨å¯¹åº”çš„åˆçº¦æŒ‡ä»¤ï¼Œå…¶ä¸­åªéœ€è¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accounts(&#123; a: keypair.publicKey &#125;).signers([keypair]).rpc(),</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­æœ‰payerå’Œaä¸¤ä¸ªå­—æ®µï¼Œä½†æ˜¯è¿™é‡Œåªéœ€è¦aè¿™ä¸ªè´¦æˆ·ï¼Œå› ä¸ºé»˜è®¤è¿æ¥çš„é’±åŒ…è´¦æˆ·ä¼šåŠ å…¥å› ä¸ºï¼Œå°±ä¸éœ€è¦æ˜¾å¼å¾—ä¼ å…¥è¿™ä¸ªå­—æ®µ</p>
<p>åŒ…è£…å®Œæˆåå¯ä»¥é€šè¿‡ï¼Œè·å–åˆ°æ‰€æœ‰è´¦æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const accounts = useQuery(&#123;</span><br><span class="line">  queryKey: [&#x27;a&#x27;, &#x27;all&#x27;, &#123; cluster &#125;],</span><br><span class="line">  queryFn: () =&gt; program.account.a.all(),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨æµ‹è¯•æ–‡ä»¶å¯ä»¥é€šè¿‡fetchè·å–åˆ°å¯¹åº”çš„è´¦æˆ·</p>
<p>å…¶ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; getAProgram, getAProgramId &#125; from &#x27;@project/anchor&#x27;</span><br></pre></td></tr></table></figure>

<p>æ˜¯é€šè¿‡æ­¤å¤„è°ƒç”¨çš„åœ¨tsconfig,jsonå¯ä»¥çœ‹åˆ°æ˜¯åˆ«å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;paths&quot;: &#123;</span><br><span class="line">    &quot;@project/anchor&quot;: [&quot;anchor/src&quot;],</span><br><span class="line">    &quot;@/*&quot;: [&quot;./src/*&quot;]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ç‰ˆæœ¬æœ€å¥½æ˜¯åˆ«æ”¹ï¼Œç‰ˆæœ¬å·å’Œä¾èµ–åŒ…æ”¹äº†ä¼šå¯¼è‡´å¾ˆå¤šå¼‚å¸¸</p>
<h1 id="ETFå’Œåˆ›é€ æŒ‡ä»¤å®ç°"><a href="#ETFå’Œåˆ›é€ æŒ‡ä»¤å®ç°" class="headerlink" title="ETFå’Œåˆ›é€ æŒ‡ä»¤å®ç°"></a>ETFå’Œåˆ›é€ æŒ‡ä»¤å®ç°</h1><p>å¯¹äºETFæ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªETF token</p>
<p>token program</p>
<p>ç¬¬ä¸€æ­¥</p>
<p>-&gt; token account,: mint(token),authority&#x2F;owner A</p>
<p>-&gt;mint account:decimals, mint_authority</p>
<p>-&gt;mint account etf: authority, decimals</p>
<p>ç¬¬äºŒæ­¥</p>
<p>user -&gt; program -&gt;</p>
<p>taken_info: name, symbol, consititunent</p>
<h2 id="åˆ›å»ºETF"><a href="#åˆ›å»ºETF" class="headerlink" title="åˆ›å»ºETF"></a>åˆ›å»ºETF</h2><p>1.å°†ETFåŒ…å«çš„èµ„äº§ä»æŒ‡ä»¤å‚æ•°ä¼ å…¥</p>
<p>å®ç°ç®€å•ï¼Œä½†æ— æ³•æ ¡éªŒspl-tokençš„çº¦æŸï¼ŒåŒæ—¶åˆçº¦æ— æ³•åŒæ­¥åˆ›å»ºå„tokençš„associated address</p>
<p>å¯ä»¥åœ¨è°ƒç”¨å‰ç«¯ä»£ç æ—¶å®Œæˆæ ¡éªŒï¼Œä»¥åŠåŒæ­¥åŒæ—¶åˆ›å»ºATAè´¦æˆ·</p>
<h2 id="å®è·µ-1"><a href="#å®è·µ-1" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">solana deactivate-stake stake-account.json -u localhost</span><br><span class="line"></span><br><span class="line">solana program dump -h</span><br><span class="line"></span><br><span class="line">solana program dump --url mainnet-beta metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br><span class="line"></span><br><span class="line">solana-test-validator -r --bpf-program metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s metadata.so</span><br></pre></td></tr></table></figure>

<p>æè¿°æˆ#[account]ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å®ç°åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p>
<p>å¯¹åˆçº¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor keys sync</span><br></pre></td></tr></table></figure>

<p>åŒæ­¥åˆ›å»ºATAè´¦æˆ·ï¼ŒATAè´¦æˆ·èƒ½å¤Ÿåˆ›å»ºå‡ºæ¥åˆ™ä¸€å®šæ˜¯ä¸€ä¸ªåˆæ³•çš„mintâ€”â€”token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-token</span><br></pre></td></tr></table></figure>

<p>1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-token</span><br><span class="line">Creating token Hxg8q5eyeXETVKV7ZTq26x21TLdYXZE73Xd42vxyAiJ1 under program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br><span class="line"></span><br><span class="line">Address:  Hxg8q5eyeXETVKV7ZTq26x21TLdYXZE73Xd42vxyAiJ1</span><br><span class="line">Decimals:  9</span><br><span class="line"></span><br><span class="line">Signature: 4ZuivgQP5vJt8CexPhdDsvX5Yrco2zZrZe4iFku6b4VXYr64gCQTxNjuUzCC9mg2p2tpS3gjv7hZsjHPqirQrVhD</span><br></pre></td></tr></table></figure>

<p>2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-token</span><br><span class="line">Creating token FStgXqadQSJKMgMAhsv1beFxA54kfLpUNXs1GFfEvjif under program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA</span><br><span class="line"></span><br><span class="line">Address:  FStgXqadQSJKMgMAhsv1beFxA54kfLpUNXs1GFfEvjif</span><br><span class="line">Decimals:  9</span><br><span class="line"></span><br><span class="line">Signature: 3LTquZ1SaySGRgtxAwaipnv7TvT67Hh5tTA8wjvjJ74jeiNkEYDUxTDACKaRWzyVu9nBAobvXzhAqHfcELAd6qnv</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="ETFçš„è´­ä¹°ã€èµå›ã€æ‰©å±•"><a href="#ETFçš„è´­ä¹°ã€èµå›ã€æ‰©å±•" class="headerlink" title="ETFçš„è´­ä¹°ã€èµå›ã€æ‰©å±•"></a>ETFçš„è´­ä¹°ã€èµå›ã€æ‰©å±•</h1><p>è´­ä¹°æ–¹æ¡ˆ1ï¼šå‰ç«¯</p>
<ol>
<li>ç”¨æˆ·ï¼šé€šè¿‡rayæˆ–okxç­‰å¹³å°å°†Solæ¢æˆå…¶ä»–Token</li>
<li>ç”¨æˆ· transfer jsolå’Œmsolåˆ°åˆçº¦</li>
<li>åˆçº¦: mint100ä»½ETFç»™ç”¨æˆ·</li>
</ol>
<p>æ–¹æ¡ˆ2ï¼š åˆçº¦swap</p>
<ol>
<li>ç”¨æˆ·ï¼štransfer å¯¹åº”solåˆ°åˆçº¦</li>
<li>åˆçº¦ï¼šé€šè¿‡rayæˆ–okxç­‰å¹³å°å°†Solæ¢æˆå¯¹åº”token</li>
<li>åˆçº¦ï¼šmint100ä»½ETFç»™ç”¨æˆ·</li>
</ol>
<h2 id="å®è·µ-2"><a href="#å®è·µ-2" class="headerlink" title="å®è·µ"></a>å®è·µ</h2><h3 id="é”™è¯¯1"><a href="#é”™è¯¯1" class="headerlink" title="é”™è¯¯1"></a>é”™è¯¯1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x27;Program Dk1ARiDNBqsoPC3D1n5kzFZpr9u5XU2AhPsrPw71rKxW invoke [1]&#x27;,</span><br><span class="line">   &#x27;Program log: Instruction: EtfMint&#x27;,</span><br><span class="line">   &#x27;Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA invoke [2]&#x27;,</span><br><span class="line">   &#x27;Program log: Instruction: Transfer&#x27;,</span><br><span class="line">   &#x27;Program log: Error: InvalidAccountData&#x27;,</span><br><span class="line">   &#x27;Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA consumed 1271 of 176596 compute units&#x27;,</span><br><span class="line">   &#x27;Program TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA failed: invalid account data for instruction&#x27;,</span><br><span class="line">   &#x27;Program Dk1ARiDNBqsoPC3D1n5kzFZpr9u5XU2AhPsrPw71rKxW consumed 24675 of 200000 compute units&#x27;,</span><br><span class="line">   &#x27;Program Dk1ARiDNBqsoPC3D1n5kzFZpr9u5XU2AhPsrPw71rKxW failed: invalid account data for instruction&#x27;</span><br><span class="line"> ],</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºataåœ°å€æ²¡æœ‰ä½™é¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> spl-token create-account 6GwhqGDHvk9ibe1KkTVFLru65VgUkRoYfMfr1W14UWeU</span><br><span class="line">Creating account 3GNWWyEqDQ5omzSKZpWqAtb2YzXGFKzXnTKumWLgorb3</span><br><span class="line"></span><br><span class="line">Signature: CktcwKJsUn3TdJHvgDNc3RZikyRdZaYmgzFrGw9qvK4uM72JPLCVC4zxVBxkfyhaMdKaZLjbpaMZgxfhs29Mywf</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">spl-token mint 6GwhqGDHvk9ibe1KkTVFLru65VgUkRoYfMfr1W14UWeU 100</span><br><span class="line">Minting 100 tokens</span><br><span class="line">  Token: 6GwhqGDHvk9ibe1KkTVFLru65VgUkRoYfMfr1W14UWeU</span><br><span class="line">  Recipient: 3GNWWyEqDQ5omzSKZpWqAtb2YzXGFKzXnTKumWLgorb3</span><br><span class="line"></span><br><span class="line">Signature: 2KiPEribVRMopPqiCKzgWNJNZu6oJRfdKBRv8LVobYcgR8ovxwWMBgfDYrsrUxDr1wQC3YsGK1DmjiS3ZAqw8rVP</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spl-token mint ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi 100</span><br><span class="line">Error: &quot;Account AMqHRcAwjNggjij3rReMEFxXWqzDSczGs5VPLBqBarN not found&quot;</span><br></pre></td></tr></table></figure>

<p>3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spl-token create-account ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi</span><br><span class="line"></span><br><span class="line">Creating account AMqHRcAwjNggjij3rReMEFxXWqzDSczGs5VPLBqBarN</span><br><span class="line"></span><br><span class="line">Signature: 2jdzqaVcL73Y68YpLEPnmuJ8b4Lq4bsE4m9PHgq2LdP4Hs3TmjMiMCxdHSw2uDm7DCDst6DGpYaERDrxjTAqwMfJ</span><br></pre></td></tr></table></figure>

<p>4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# spl-token mint ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi 100</span><br><span class="line">Minting 100 tokens</span><br><span class="line">  Token: ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi</span><br><span class="line">  Recipient: AMqHRcAwjNggjij3rReMEFxXWqzDSczGs5VPLBqBarN</span><br><span class="line"></span><br><span class="line">Signature: 292pddjwNdgAKPswwk1a3rX65KDZicmCEdb7snESkKFR5iz3zrSpdAuBaAUQ7qwJNPbikKnnaAX5PhUs6nUjJX4t</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>5</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">spl-token accounts</span><br><span class="line"></span><br><span class="line">LAPTOP-6M4RE4LA# spl-token accounts</span><br><span class="line">Token                                         Balance</span><br><span class="line">-----------------------------------------------------</span><br><span class="line">6GwhqGDHvk9ibe1KkTVFLru65VgUkRoYfMfr1W14UWeU  100</span><br><span class="line">Aq8NzyHt1FPVfStH9dFJKTMRwsccHn7eANdgzVdoQFcQ  0  </span><br><span class="line">ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi  100</span><br></pre></td></tr></table></figure>

<p>6</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">LAPTOP-6M4RE4LA# anchor run example</span><br><span class="line">bigint: Failed to load bindings, pure JS will be used (try npm run rebuild?)</span><br><span class="line">Aq8NzyHt1FPVfStH9dFJKTMRwsccHn7eANdgzVdoQFcQ</span><br><span class="line">(node:31225) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.</span><br><span class="line">(Use `node --trace-deprecation ...` to show where the warning was created)</span><br><span class="line">3aDxoQD4AEr4xVeyxCXWhn3gdMPjxzxt7TxBkgYjpH4dims5wZFhZtSTWLf8PKPs74rYa3VgfQKxPALbgH85wsBg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LAPTOP-6M4RE4LA# spl-token accounts</span><br><span class="line">Token                                         Balance</span><br><span class="line">-----------------------------------------------------</span><br><span class="line">6GwhqGDHvk9ibe1KkTVFLru65VgUkRoYfMfr1W14UWeU  91</span><br><span class="line">Aq8NzyHt1FPVfStH9dFJKTMRwsccHn7eANdgzVdoQFcQ  10</span><br><span class="line">ByuipWwhbTvYAD3kvfhVpeZfz7EofkkYfrfaoahRigXi  99</span><br></pre></td></tr></table></figure>



<p>åœ¨æ²¡æœ‰mintç›¸åº”çš„tokenä¹‹å‰ï¼Œå³ä½¿è¿è¡Œrun exampleç›¸åº”çš„etfä¹Ÿæ˜¯0</p>
<h2 id="èµå›"><a href="#èµå›" class="headerlink" title="èµå›"></a>èµå›</h2><p>æ–¹æ¡ˆï¼š</p>
<p>ç”¨æˆ·ï¼š burn 100ä»½ETF</p>
<p>åˆçº¦ï¼š transferå¯¹åº”ä»½é¢çš„tokenç»™ç”¨æˆ·</p>
<p>ç”¨æˆ·ï¼šé€šè¿‡å„å¹³å°å°†å„tokenæ¢æˆsol</p>
<h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><p>å°†etfåŒ…å«çš„èµ„äº§ä»è´¦æˆ·ä¼ å…¥ï¼Œåˆ†æ•£åœ¨å¤šä¸ªåˆçº¦ä¸­</p>
<p>è·å–etfåˆ—è¡¨</p>
<p>umiåº“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pnpm install @metaplex-foundation/umi-bundle-defaults</span><br><span class="line"></span><br><span class="line">npm install @metaplex-foundation/umi-bundle-defaults</span><br><span class="line"></span><br><span class="line">npm install @metaplex-foundation/umi</span><br><span class="line"></span><br><span class="line">npm install @metaplex-foundation/mpl-token-metadata</span><br><span class="line">npm install @metaplex-foundation/umi-web3js-adapters</span><br></pre></td></tr></table></figure>








      
    </div>
    <footer class="article-footer">
      <a data-url="https://auo578.github.io/2024/04/01/%E5%A4%8D%E4%B9%A0/" data-id="cm91nrz3t0000ugu77o2i870x" data-title="Solçš„æ¶æ„å’Œåè¯æ¦‚å¿µ" class="article-share-link">åˆ†äº«</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SOLANA%E9%A1%B9%E7%9B%AE%E5%85%A5%E9%97%A81/" rel="tag">SOLANAé¡¹ç›®å…¥é—¨1</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/09/12/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">å‰ä¸€ç¯‡</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust%E5%9F%BA%E7%A1%80/" rel="tag">RuståŸºç¡€</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOLANA%E9%A1%B9%E7%9B%AE%E5%85%A5%E9%97%A81/" rel="tag">SOLANAé¡¹ç›®å…¥é—¨1</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOLANA%E9%A1%B9%E7%9B%AE%E5%85%A5%E9%97%A82-anchor/" rel="tag">SOLANAé¡¹ç›®å…¥é—¨2---anchor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/program%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" rel="tag">programå·¥å…·ä½¿ç”¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/solidity%E5%85%A5%E9%97%A8/" rel="tag">solidityå…¥é—¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%82%96%E8%80%81%E5%B8%88%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" rel="tag">è‚–è€å¸ˆè¯¾ç¨‹ç¬”è®°</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/17/2025317-%E7%9B%B8%E5%85%B3%E7%B3%BB%E7%BB%9F%E8%B4%A6%E6%88%B7%E5%AF%B9%E4%B8%8D%E4%B8%8A/">ç›¸å…³ç³»ç»Ÿè´¦æˆ·å¯¹ä¸ä¸Š</a>
          </li>
        
          <li>
            <a href="/2025/01/21/solidity%E5%85%A5%E9%97%A81/">solidityå…¥é—¨1</a>
          </li>
        
          <li>
            <a href="/2025/01/06/2024126-solana%E6%B5%81%E5%8A%A8%E6%80%A7%E8%B4%A8%E6%8A%BC/">solanaæµåŠ¨æ€§è´¨æŠ¼</a>
          </li>
        
          <li>
            <a href="/2024/12/10/%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6/">SPLtokenåˆçº¦åˆ›å»º</a>
          </li>
        
          <li>
            <a href="/2024/12/09/2024129-github%E7%9A%84%E4%BD%BF%E7%94%A8/">githubçš„ä½¿ç”¨</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">ä¸‰æœˆ 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">ä¸€æœˆ 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">åäºŒæœˆ 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">åæœˆ 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">ä¹æœˆ 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">å››æœˆ 2024</a></li></ul>
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 By Autoload<br>
      Driven - <a href="https://hexo.io/" target="_blank">Hexo</a>|Theme - <a href="https://github.com/autoload/hexo-theme-auto" target="_blank">Auto</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/script.js"></script>




  </div>
</body>
</html>