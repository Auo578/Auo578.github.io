<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>北大肖臻老师《区块链技术与应用》笔记14-15 | Auodesy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Auodesy</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-肖14-15" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/01/%E8%82%9614-15/" class="article-date">
  <time class="dt-published" datetime="2024-09-30T16:29:35.000Z" itemprop="datePublished">2024-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      北大肖臻老师《区块链技术与应用》笔记14-15
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="课程14：以太坊概述"><a href="#课程14：以太坊概述" class="headerlink" title="课程14：以太坊概述"></a>课程14：以太坊概述</h1><p>比特币和以太坊是两种最主要的加密货币。比特币被称为区块链1.0，以太坊被称为区块链2.0，以太坊在系统设计上，针对比特币的运行过程中出现的一些问题进行了改进，比如</p>
<p><strong>1.出块时间：</strong></p>
<p>比特币：10分钟</p>
<p>以太坊：十几秒，基于这个出块时间，以太坊设计了一套基于ghost协议的共识机制。</p>
<p><strong>2.针对挖矿使用的mining puzzle</strong></p>
<p>比特币：计算密集型，比拼的是计算哈希值的算力-&gt;挖矿设备的专业化，</p>
<p>以太坊：memory hard mining puzzle ,对内存的要求很高,设计的目的在一定程度上限制了asic芯片的使用，asic resistance，用权益证明来替代工作量证明。proof of work -&gt; proof of stake。不挖矿，类似于股份投票的方法决定下一个区块该怎么产生</p>
<p><strong>3.对智能合约的支持smart contract</strong></p>
<p>比特币实现一种去中心化的货币，decentralized currency，如果货币可以去中心化还有什么是可以去中心的？</p>
<p>Ethereum智能合约，增加了去中心化的合约的支持，decentralized contract,币Ether。</p>
<p>比特币的最小计量单位，1 satoshi,为了纪念中本聪。</p>
<p>以太坊。 1wei，也是一个人名。</p>
<h2 id="去中心化的智能合约"><a href="#去中心化的智能合约" class="headerlink" title="去中心化的智能合约"></a>去中心化的智能合约</h2><p>货币的价值是建立在政府公信力的基础上，然后政府通过司法手段来维持这个金融体系的运行。</p>
<p>比特币的出现，用技术手段把政府的这些职能给取代了，通过密码学、共识机制来维护加密货币体系的正常运行。</p>
<p>去中心化的合约也是这个意思，合约（合同）也是应该通过司法手段通过政府来维护的，例如合同打官司。用技术手段把这个司法手段给取代了，这个技术以太坊智能合约的一个设计目的。</p>
<p>如果合同中的内容是可以通过程序代码来实现的，就可以把这个代码放到区块链上，通过区块链的不可篡改性来保证代码的正确运行。当然，不是所有的合同的内容都可以用编程语言来实现，也不是所有的合同条款都是可以量化的，但是有些逻辑比较简单比较清晰的合同是可以写成智能合约的形式。</p>
<h3 id="这种去中心化的合同有什么好处？"><a href="#这种去中心化的合同有什么好处？" class="headerlink" title="这种去中心化的合同有什么好处？"></a>这种去中心化的合同有什么好处？</h3><p>去中心化的货币的好处和法币相比？fiat currency，去中心化的货币有的应用场景是跨国转账，比法币快。</p>
<p>智能合约也有类似的场景，如果合同的签署方是来自世界各地的，没有一个统一的司法管辖权，这个时候用司法手段来维护合同的有效性就比较困难，比如众筹，通过事先写好的程序代码来保证每个人都只能按照这个规则来执行，这是一种比较好的解决方法。其实计算是合同的参与方都在同一个司法管辖权之下的，真正想通过司法手段来维护合同的执行，也是一个比较费时费力的过程，看打官司。所以最好是用技术手段来保证合同的参与方从一开始就不可能违约。而智能合约的一个好处就在于，这个代码一旦发布到区块链，那么区块链的不可篡改性保证大家就只能按照代码中制定的规则来执行。</p>
<h1 id="课程15：以太坊的账户"><a href="#课程15：以太坊的账户" class="headerlink" title="课程15：以太坊的账户"></a>课程15：以太坊的账户</h1><p>以太坊系统中采用的账户模式，比特币中用的是基于交易的账本，transaction base natrue，这种模式下，系统中并没有显示的记录每个账户上有多少钱，根据utxo推算。好处是隐私保护比较好，问题是使用上比较别扭，证明交易的币的来源合法性，花钱说明。</p>
<p>在前面收到一些币和一些输出，将来花的时候必须要一次性都花出去。如果只花一部分，那么剩下的部分都会当作transacton费花出去了，miner exctied（哈哈哈）</p>
<p>所以必须把剩下的比特币转回给自己，很多的比特币钱包可以自动生成这种接收余额的地址，每次交易换一次地址，也有利于隐私保护，但同样和日常生活习惯不太一样。问题在于比特币系统中没有显式地维护这种基于账户交易的概念，它是每个交易单独进行处理的。</p>
<p><strong>以太坊系统</strong>中采用的是基于账户的模型，account-based ledger，和日常习惯比较相近，显式地记录每个账户上有多少个以太币。转钱只要证明账户中是否有足够多的钱，不用说明其中是具体把哪十个币转给了接收者，不用说明这些币的来源是来自哪些交易的。也不用一次全部转出，可以转出一部分，也不用把剩下的转给自己，因为有显式的余额的概念，所以剩下的币直接放到账户上就可以了。哈希指针也不用说明币的来源。</p>
<p><strong>好处</strong>是对double spending attack有天然的防御作用，因为不用管币的来源，每花一次钱，就往账户里扣钱，花两次就扣两次。</p>
<p><strong>关于篡改账户余额？</strong>以太坊中的余额是系统中全节点维护的状态中要保存的，以太坊中一个重要的数据结构是状态数。状态数就是所有的账户的状态组成一颗树。转给账户状态里包含的一个重要的域就是balance（余额），这个余额没有办法改，如果要改得是所有的全节点都认为这个余额是发生了变化，否则其他节点是不认的。</p>
<p><strong>坏处</strong>：replay attack，假设a转给b10个以太币，而b有恶意，在转过去之后，把这个交易又在网上重新广播一遍，其他节点认可则以为a又转给b一笔相同的钱，就把a的钱扣了2次。和double spending是对称的，double是指花钱的人不诚实，把钱花一遍。replay则是收钱的人不成熟，想要再收一遍。比特币中的重放攻击是很明显的double spending。</p>
<p><strong>以太坊对付的办法</strong>：</p>
<p>加一个计数器交易次数：记录账户有史以来一共发布过多少个交易。然后转账的时候，这个交易次数要成为交易内容的一部分，一起包含进去。这些都是收到发布交易者的签名保护的，例子中：nonse（次数），因为有签名的保护，nonse的值改不了。然后系统中的每个节点维护a账户的状态，不光是要维护a的balance，还要维护nonse的值。nonse，新创立的时候nonse&#x3D;0，每次收到这个账户发起的交易nonse+1.</p>
<p>所以如果有人想重放交易，因为nonse的值已经是21了，节点认为已经执行过了，就不会再执行一遍了。</p>
<h2 id="以太坊账户"><a href="#以太坊账户" class="headerlink" title="以太坊账户"></a>以太坊账户</h2><p>以太坊中有两类账户，一类是外部账户（externally owned account）类似于比特币的账户，用公私钥控制，私钥证明控制权，也管这个叫普通账户，有balance和nonse（counter、sequence number）。</p>
<p>第二类账户是合约账户，smart contract account，合约账户不是通过公私钥对控制的，合约账户同样有balance和nonse，一个合约可以调用另一个合约，所以同样要通过nonse记录调用的次数。但是合约账户不能主动发起一个交易，以太坊规定，所有的交易只能由外部账户发起。外部账户发起交易，如果调用了一个合约账户，这个合约账户可以发送一个message调用另外一个合约，但是合约账户不能平白的发起一个交易。</p>
<p>合约账户有：balance、nonse、code（代码）、<br>storage（相关的状态，包括每个变量的取值）</p>
<h3 id="合约账户怎么被调用"><a href="#合约账户怎么被调用" class="headerlink" title="合约账户怎么被调用"></a>合约账户怎么被调用</h3><p>创造合约的时候会返回一个地址，知道这个合约的地址就可以调用这个合约，调用的过程中，这个状态会发送变化，代码是不变的，storage存储会发生变化。</p>
<h3 id="为什么要设计这种新的模型？"><a href="#为什么要设计这种新的模型？" class="headerlink" title="为什么要设计这种新的模型？"></a>为什么要设计这种新的模型？</h3><p>当创建以太坊时，比特币已经有比较成熟的代码可以做一些参考，为什么不用已有的代码？可以在系统设计上改进出块时间，mining puzzle，不一定非要改账户系统。</p>
<p>比特币基于交易的账户模型的好处是隐私保护较好，每次交易可以换一个新的账户。</p>
<p>而以太坊要支持的是智能合约，对于合约来说，要求参与者有比较稳定的身份，类似日常生活。现在有人提出用智能合约实现一些金融的衍生品，所谓的financial derivative，比如期权期货。比如投钱给合约账户，投完之后，合约地址变了。。。所以以太坊创建这个系统的时候，采用了account-based ledger.</p>
<p>如果有隐私保护的需要，同样可以创建多个账户，根据情况使用不同的账户进行交易。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auo578.github.io/2024/10/01/%E8%82%9614-15/" data-id="cm477y2nc0010c4u7430o6wx1" data-title="北大肖臻老师《区块链技术与应用》笔记14-15" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%82%96%E8%80%81%E5%B8%88%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" rel="tag">肖老师课程笔记</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/10/03/16-17/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          北大肖臻老师《区块链技术与应用》笔记16-17
        
      </div>
    </a>
  
  
    <a href="/2024/09/30/12-13/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">北大肖臻老师《区块链技术与应用》笔记12-13</div>
    </a>
  
</nav>

  
</article>


</section>
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rust%E5%9F%BA%E7%A1%80/" rel="tag">Rust基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOLANA%E9%A1%B9%E7%9B%AE%E5%85%A5%E9%97%A81/" rel="tag">SOLANA项目入门1</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%82%96%E8%80%81%E5%B8%88%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" rel="tag">肖老师课程笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/02/2024121-SOLANA%E7%A4%BE%E4%BA%A4%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B51/">SOLANA社交项目实践1</a>
          </li>
        
          <li>
            <a href="/2024/12/01/SPLtoken%E5%90%88%E7%BA%A6%E5%88%9B%E5%BB%BA/">SPLtoken合约创建</a>
          </li>
        
          <li>
            <a href="/2024/12/01/solana%E5%9F%BA%E7%A1%80-%E8%B4%A6%E6%88%B7%E5%92%8C%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%A4%E4%BA%92/">Sol账户和交互、token创建</a>
          </li>
        
          <li>
            <a href="/2024/12/01/Solona%E4%BB%8B%E7%BB%8D/">Sol基础介绍</a>
          </li>
        
          <li>
            <a href="/2024/12/01/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/">思维导图</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">十月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">九月 2024</a></li></ul>
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 By Autoload<br>
      Driven - <a href="https://hexo.io/" target="_blank">Hexo</a>|Theme - <a href="https://github.com/autoload/hexo-theme-auto" target="_blank">Auto</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/script.js"></script>




  </div>
</body>
</html>